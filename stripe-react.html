<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Stripe Payments Integration 101 Roland SzÅ‘ke January 29, 2019
(C) 2019 -->
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Stripe Payments Integration 101</title>

<meta name="description" content="Stripe Payments Integration 101">
<meta name="keywords" content="Stripe Payments Integration 101">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="#Top" rel="start" title="Top">
<link href="#CONCEPT-INDEX" rel="index" title="CONCEPT INDEX">
<link href="#SEC_Contents" rel="contents" title="Table of Contents">
<link href="dir.html#Top" rel="up" title="(dir)">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<h1 class="settitle" align="center">Stripe Payments Integration 101</h1>




<a name="SEC_Contents"></a>
<h2 class="contents-heading">Table of Contents</h2>

<div class="contents">

<ul class="no-bullet">
  <li><a name="toc-Introduction-1" href="#Introduction">1 Introduction</a>
  <ul class="no-bullet">
    <li><a name="toc-About-The-Author-1" href="#About-The-Author">1.1 About The Author</a></li>
    <li><a name="toc-About-the-Project-1" href="#About-the-Project">1.2 About the Project</a></li>
  </ul></li>
  <li><a name="toc-The-Basics-of-Stripe-Payments-Integration-1" href="#The-Basics-of-Stripe-Payments-Integration">2 The Basics of Stripe Payments Integration</a>
  <ul class="no-bullet">
    <li><a name="toc-Stripe-Setup-and-Dashboard-1" href="#Stripe-Setup-and-Dashboard">2.1 Stripe Setup and Dashboard</a>
    <ul class="no-bullet">
      <li><a name="toc-Signup-To-Stripe-1" href="#Signup-To-Stripe">2.1.1 Signup To Stripe</a></li>
      <li><a name="toc-Create-a-New-Coupon-or-Product-1" href="#Create-a-New-Coupon-or-Product">2.1.2 Create a New Coupon or Product</a></li>
      <li><a name="toc-Integrate-Stripe-Into-a-Product-1" href="#Integrate-Stripe-Into-a-Product">2.1.3 Integrate Stripe Into a Product</a></li>
      <li><a name="toc-Stripe-Developers-Section-1" href="#Stripe-Developers-Section">2.1.4 Stripe Developers Section</a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Creating-a-Webshop-in-React-with-Charges-1" href="#Creating-a-Webshop-in-React-with-Charges">3 Creating a Webshop in React with Charges</a>
  <ul class="no-bullet">
    <li><a name="toc-Steps-for-Creating-a-Webshop-1" href="#Steps-for-Creating-a-Webshop">3.1 Steps for Creating a Webshop</a></li>
    <li><a name="toc-Terminal-Commands-To-Build-the-React-App-1" href="#Terminal-Commands-To-Build-the-React-App">3.2 Terminal Commands To Build the React App</a>
    <ul class="no-bullet">
      <li><a name="toc-Create-the-React-App-and-Install-Stripe-Elements-and-Axios-1" href="#Create-the-React-App-and-Install-Stripe-Elements-and-Axios">3.2.1 Create the React App and Install Stripe Elements and Axios</a></li>
      <li><a name="toc-Add-Stripe_002ejs-Code-to-index_002ehtml-File" href="#Add-Stripejs-Code-to-indexhtml-File">3.2.2 Add <code>Stripe.js</code> Code to <code>index.html</code> File</a></li>
    </ul></li>
    <li><a name="toc-Coding-the-App-1" href="#Coding-the-App">3.3 Coding the App</a>
    <ul class="no-bullet">
      <li><a name="toc-Stripe-Object-in-Root-React-Component-App_002ejs" href="#Stripe-Object-in-Root-React-Component-Appjs">3.3.1 Stripe Object in Root React Component <samp>App.js</samp></a></li>
      <li><a name="toc-Implementation-of-Shop_002ejs-Component" href="#Implementation-of-Shopjs-Component">3.3.2 Implementation of <samp>Shop.js</samp> Component</a></li>
      <li><a name="toc-Explanation-of-Shop_002ejs" href="#Explanation-of-Shopjs">3.3.3 Explanation of <samp>Shop.js</samp></a></li>
      <li><a name="toc-POST-Request-to-Stripe-1" href="#POST-Request-to-Stripe">3.3.4 POST Request to Stripe</a></li>
      <li><a name="toc-Charge-a-Credit-Card-in-Shop_002ejs" href="#Charge-a-Credit-Card-in-Shopjs">3.3.5 Charge a Credit Card in <samp>Shop.js</samp></a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Placing-an-Order-With-Stripe-1" href="#Placing-an-Order-With-Stripe">4 Placing an Order With Stripe</a>
  <ul class="no-bullet">
    <li><a name="toc-Set-Up-an-Express-Server-1" href="#Set-Up-an-Express-Server">4.1 Set Up an Express Server</a>
    <ul class="no-bullet">
      <li><a name="toc-Access-Stripe-in-Server-index_002ejs" href="#Access-Stripe-in-Server-indexjs">4.1.1 Access Stripe in Server <code>index.js</code></a></li>
      <li><a name="toc-Stripe-Customers-1" href="#Stripe-Customers">4.1.2 Stripe Customers</a></li>
      <li><a name="toc-Use-Card-Token-as-Source-1" href="#Use-Card-Token-as-Source">4.1.3 Use Card Token as &lsquo;<samp>Source</samp>&rsquo;</a></li>
      <li><a name="toc-Implement-CC-Charges-in-index_002ejs" href="#Implement-CC-Charges-in-indexjs">4.1.4 Implement CC Charges in <code>index.js</code></a></li>
    </ul></li>
    <li><a name="toc-Handle-Orders-on-the-Front-End-1" href="#Handle-Orders-on-the-Front-End">4.2 Handle Orders on the Front End</a>
    <ul class="no-bullet">
      <li><a name="toc-Implement-State-of-Shop-Component-1" href="#Implement-State-of-Shop-Component">4.2.1 Implement State of Shop Component</a></li>
      <li><a name="toc-Create-Input-Fields-1" href="#Create-Input-Fields">4.2.2 Create Input Fields</a></li>
      <li><a name="toc-Create-Products-and-Assign-SKUs-1" href="#Create-Products-and-Assign-SKUs">4.2.3 Create Products and Assign SKUs</a></li>
      <li><a name="toc-Add-Products-to-the-Webshop-1" href="#Add-Products-to-the-Webshop">4.2.4 Add Products to the Webshop</a></li>
      <li><a name="toc-Send-Orders-to-Stripe-API-on-Submit-1" href="#Send-Orders-to-Stripe-API-on-Submit">4.2.5 Send Orders to Stripe API on Submit</a></li>
      <li><a name="toc-Create-a-Coupon-for-Testing-1" href="#Create-a-Coupon-for-Testing">4.2.6 Create a Coupon for Testing</a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Setting-up-Stripe-Webhooks-to-Verify-Payments-1" href="#Setting-up-Stripe-Webhooks-to-Verify-Payments">5 Setting up Stripe Webhooks to Verify Payments</a>
  <ul class="no-bullet">
    <li><a name="toc-Webhook-Notification-When-Order-Gets-Paid-1" href="#Webhook-Notification-When-Order-Gets-Paid">5.1 Webhook Notification When Order Gets Paid</a>
    <ul class="no-bullet">
      <li><a name="toc-Webhook-Setup-using-Stripe-Dashboard-1" href="#Webhook-Setup-using-Stripe-Dashboard">5.1.1 Webhook Setup using Stripe Dashboard</a></li>
      <li><a name="toc-Decrypting-Request-Body-Sent-by-Stripe-1" href="#Decrypting-Request-Body-Sent-by-Stripe">5.1.2 Decrypting Request Body Sent by Stripe</a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Wrapping-It-Up-1" href="#Wrapping-It-Up">6 Wrapping It Up</a></li>
  <li><a name="toc-LIST-OF-FIGURES-1" href="#LIST-OF-FIGURES">LIST OF FIGURES</a></li>
  <li><a name="toc-LIST-OF-CODE-FRAGMENTS-1" href="#LIST-OF-CODE-FRAGMENTS">LIST OF CODE FRAGMENTS</a></li>
  <li><a name="toc-CONCEPT-INDEX-1" href="#CONCEPT-INDEX">CONCEPT INDEX</a></li>
  <li><a name="toc-SOURCE-INDEX-1" href="#SOURCE-INDEX">SOURCE INDEX</a></li>
</ul>
</div>


<a name="Top"></a>
<div class="header">
<p>
Next: <a href="#Introduction" accesskey="n" rel="next">Introduction</a>, Up: <a href="dir.html#Top" accesskey="u" rel="up">(dir)</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Stripe-Payments-Integration-101"></a>
<h1 class="top">Stripe Payments Integration 101</h1>

<p>Sample app, detailed guidance &amp; best practices to help you get started
with Stripe Payments integration as a JavaScript developer.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Introduction" accesskey="1">Introduction</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-Basics-of-Stripe-Payments-Integration" accesskey="2">The Basics of Stripe Payments Integration</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Creating-a-Webshop-in-React-with-Charges" accesskey="3">Creating a Webshop in React with Charges</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Placing-an-Order-With-Stripe" accesskey="4">Placing an Order With Stripe</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Setting-up-Stripe-Webhooks-to-Verify-Payments" accesskey="5">Setting up Stripe Webhooks to Verify Payments</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Wrapping-It-Up" accesskey="6">Wrapping It Up</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#LIST-OF-FIGURES" accesskey="7">LIST OF FIGURES</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#LIST-OF-CODE-FRAGMENTS" accesskey="8">LIST OF CODE FRAGMENTS</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#CONCEPT-INDEX" accesskey="9">CONCEPT INDEX</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SOURCE-INDEX">SOURCE INDEX</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr><tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">&mdash; The Detailed Node Listing &mdash;

Introduction

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#About-The-Author">About The Author</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#About-the-Project">About the Project</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

The Basics of Stripe Payments Integration

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Stripe-Setup-and-Dashboard">Stripe Setup and Dashboard</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Stripe Setup and Dashboard

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Signup-To-Stripe">Signup To Stripe</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Create-a-New-Coupon-or-Product">Create a New Coupon or Product</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Integrate-Stripe-Into-a-Product">Integrate Stripe Into a Product</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Stripe-Developers-Section">Stripe Developers Section</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Creating a Webshop in React with Charges

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Terminal-Commands-To-Build-the-React-App">Terminal Commands To Build the React App</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Coding-the-App">Coding the App</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Terminal Commands To Build the React App

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Create-the-React-App-and-Install-Stripe-Elements-and-Axios">Create the React App and Install Stripe Elements and Axios</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Add-Stripejs-Code-to-indexhtml-File">Add <code>Stripe.js</code> Code to <code>index.html</code> File</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Coding the App

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>App.js</samp></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Implementation-of-Shopjs-Component">Implementation of <samp>Shop.js</samp> Component</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Explanation-of-Shopjs">Explanation of <samp>Shop.js</samp></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#POST-Request-to-Stripe">POST Request to Stripe</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Charge-a-Credit-Card-in-Shopjs">Charge a Credit Card in <samp>Shop.js</samp></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Placing an Order With Stripe

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Set-Up-an-Express-Server">Set Up an Express Server</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Handle-Orders-on-the-Front-End">Handle Orders on the Front End</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Set Up an Express Server

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Access-Stripe-in-Server-indexjs">Access Stripe in Server <code>index.js</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Stripe-Customers">Stripe Customers</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Use-Card-Token-as-Source">Use Card Token as &lsquo;<samp>Source</samp>&rsquo;</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Implement-CC-Charges-in-indexjs">Implement CC Charges in <code>index.js</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Handle Orders on the Front End

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Implement-State-of-Shop-Component">Implement State of Shop Component</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Create-Input-Fields">Create Input Fields</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Create-Products-and-Assign-SKUs">Create Products and Assign SKUs</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Add-Products-to-the-Webshop">Add Products to the Webshop</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Send-Orders-to-Stripe-API-on-Submit">Send Orders to Stripe API on Submit</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Create-a-Coupon-for-Testing">Create a Coupon for Testing</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Setting up Stripe Webhooks to Verify Payments

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Webhook-Notification-When-Order-Gets-Paid">Webhook Notification When Order Gets Paid</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Webhook Notification When Order Gets Paid

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Webhook-Setup-using-Stripe-Dashboard">Webhook Setup using Stripe Dashboard</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Decrypting-Request-Body-Sent-by-Stripe">Decrypting Request Body Sent by Stripe</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr></table>

<hr>
<a name="Introduction"></a>
<div class="header">
<p>
Next: <a href="#The-Basics-of-Stripe-Payments-Integration" accesskey="n" rel="next">The Basics of Stripe Payments Integration</a>, Previous: <a href="#Top" accesskey="p" rel="prev">Top</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Introduction-1"></a>
<h2 class="chapter">1 Introduction</h2>

<p>In this article, Iâ€™ll show how you can create a simple webshop using
Stripe Payments integration, React and Express. We&rsquo;ll get familiar
with the Stripe Dashboard and basic Stripe features such as charges,
customers, orders, coupons and so on. Also, you will learn about the
usage of webhooks and restricted API keys.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#About-The-Author" accesskey="1">About The Author</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#About-the-Project" accesskey="2">About the Project</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="About-The-Author"></a>
<div class="header">
<p>
Next: <a href="#About-the-Project" accesskey="n" rel="next">About the Project</a>, Up: <a href="#Introduction" accesskey="u" rel="up">Introduction</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="About-The-Author-1"></a>
<h3 class="section">1.1 About The Author</h3>

<a name="index-author_002c-about"></a>
<p>A little bit about my Stripe experience and the reasons for writing
this tutorial: At <a href="https://risingstack.com/">RisingStack</a> weâ€™ve been working with a client from
the US healthcare scene who hired us to create a large-scale
webshop they can use to sell their products. During the creation of
this Stripe based platform, we spent a lot of time with studying
the documentation and figuring out the integration. Not because it
is hard, but there&rsquo;s a certain amount of Stripe related knowledge
that you&rsquo;ll need to internalize.
</p>
<hr>
<a name="About-the-Project"></a>
<div class="header">
<p>
Previous: <a href="#About-The-Author" accesskey="p" rel="prev">About The Author</a>, Up: <a href="#Introduction" accesskey="u" rel="up">Introduction</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="About-the-Project-1"></a>
<h3 class="section">1.2 About the Project</h3>

<a name="index-project"></a>
<a name="index-frontend_002c-github"></a>
<a name="index-backend_002c-github"></a>
<a name="index-github-sources"></a>
<a name="index-Stripe-Webshop_002c-create"></a>
<p>We&rsquo;ll build an example app in this tutorial together&mdash;so you can
learn how to create a Stripe Webshop from the ground up! The
example app&rsquo;s frontend can be found at
<a href="https://github.com/RisingStack/post-stripe">https://github.com/RisingStack/post-stripe</a> , and its backend at
<a href="https://github.com/RisingStack/post-stripe-api">https://github.com/RisingStack/post-stripe-api</a>.
</p>
<a name="index-code-samples_002c-github"></a>
<p>Iâ€™ll use code samples from these repoâ€™s in the article below.
</p>
<hr>
<a name="The-Basics-of-Stripe-Payments-Integration"></a>
<div class="header">
<p>
Next: <a href="#Creating-a-Webshop-in-React-with-Charges" accesskey="n" rel="next">Creating a Webshop in React with Charges</a>, Previous: <a href="#Introduction" accesskey="p" rel="prev">Introduction</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="The-Basics-of-Stripe-Payments-Integration-1"></a>
<h2 class="chapter">2 The Basics of Stripe Payments Integration</h2>

<a name="index-Stripe_002c-what-it-is"></a>
<p>First of all, what is the promise of Stripe? It is basically a
payment provider: you set up your account, integrate it into your
application and let the money rain. Pretty simple right? Well, let
your finance people decide if it is a good provider or not based on
the plans they offer.
</p>
<p>To show you how to use Stripe, weâ€™ll build a simple demo application
with it together.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Stripe-Setup-and-Dashboard" accesskey="1">Stripe Setup and Dashboard</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Stripe-Setup-and-Dashboard"></a>
<div class="header">
<p>
Up: <a href="#The-Basics-of-Stripe-Payments-Integration" accesskey="u" rel="up">The Basics of Stripe Payments Integration</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Stripe-Setup-and-Dashboard-1"></a>
<h3 class="section">2.1 Stripe Setup and Dashboard</h3>

<a name="index-Stripe-account_002c-setup"></a>
<p>Before we start coding, we need to create a Stripe account. Don&rsquo;t
worry, no credit card is required in this stage. You only need to
provide a payment method when you attempt to activate your account.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Signup-To-Stripe" accesskey="1">Signup To Stripe</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Create-a-New-Coupon-or-Product" accesskey="2">Create a New Coupon or Product</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Integrate-Stripe-Into-a-Product" accesskey="3">Integrate Stripe Into a Product</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Stripe-Developers-Section" accesskey="4">Stripe Developers Section</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Signup-To-Stripe"></a>
<div class="header">
<p>
Next: <a href="#Create-a-New-Coupon-or-Product" accesskey="n" rel="next">Create a New Coupon or Product</a>, Up: <a href="#Stripe-Setup-and-Dashboard" accesskey="u" rel="up">Stripe Setup and Dashboard</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Signup-To-Stripe-1"></a>
<h4 class="subsection">2.1.1 Signup To Stripe</h4>

<a name="index-Stripe-dashboard"></a>
<a name="index-dashboard"></a>
<a name="index-Stripe-signup"></a>
<a name="index-signup"></a>
<p>Go straight to the <a href="https://dashboard.stripe.com/login">Stripe Dashboard</a> and hit that <strong>Sign up</strong>
button. Email, name, password&hellip; the usual. BOOM! You have a
dashboard. You can create, manage and keep track of orders,
payment flow, customers&hellip; so basically everything you want to
know regarding your shop is here.
</p>
<hr>
<a name="Create-a-New-Coupon-or-Product"></a>
<div class="header">
<p>
Next: <a href="#Integrate-Stripe-Into-a-Product" accesskey="n" rel="next">Integrate Stripe Into a Product</a>, Previous: <a href="#Signup-To-Stripe" accesskey="p" rel="prev">Signup To Stripe</a>, Up: <a href="#Stripe-Setup-and-Dashboard" accesskey="u" rel="up">Stripe Setup and Dashboard</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Create-a-New-Coupon-or-Product-1"></a>
<h4 class="subsection">2.1.2 Create a New Coupon or Product</h4>

<a name="index-coupon_002c-create-new"></a>
<a name="index-product_002c-create-new"></a>
<a name="index-create-new-coupon-or-product"></a>
<a name="index-Stripe-API-documentation_002c-link-to"></a>
<p>If you want to create a new coupon or product, you only need to
click a few buttons or enter a simple curl command to your
terminal, as the <a href="https://stripe.com/docs/api">Stripe API Doc</a> describes.
</p>
<hr>
<a name="Integrate-Stripe-Into-a-Product"></a>
<div class="header">
<p>
Next: <a href="#Stripe-Developers-Section" accesskey="n" rel="next">Stripe Developers Section</a>, Previous: <a href="#Create-a-New-Coupon-or-Product" accesskey="p" rel="prev">Create a New Coupon or Product</a>, Up: <a href="#Stripe-Setup-and-Dashboard" accesskey="u" rel="up">Stripe Setup and Dashboard</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Integrate-Stripe-Into-a-Product-1"></a>
<h4 class="subsection">2.1.3 Integrate Stripe Into a Product</h4>

<a name="index-Stripe-product-integration"></a>
<a name="index-integrate-Stripe-into-product"></a>
<a name="index-Stripe_002ejs-link"></a>
<p>Of course, you can integrate Stripe into your product so your
admins can set them up from your UI, and then integrate and expose
it to your customers using <a href="https://github.com/stripe/stripe-node">Stripe.js</a>.
</p>
<hr>
<a name="Stripe-Developers-Section"></a>
<div class="header">
<p>
Previous: <a href="#Integrate-Stripe-Into-a-Product" accesskey="p" rel="prev">Integrate Stripe Into a Product</a>, Up: <a href="#Stripe-Setup-and-Dashboard" accesskey="u" rel="up">Stripe Setup and Dashboard</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Stripe-Developers-Section-1"></a>
<h4 class="subsection">2.1.4 Stripe Developers Section</h4>

<a name="index-Developers-section_002c-Dashboard"></a>
<a name="index-dashboard_002c-Developers-section"></a>
<a name="index-webhook"></a>
<a name="index-API"></a>
<a name="index-api-keys"></a>
<a name="index-restricted-api-keys"></a>
<p>Another important menu on the dashboard is the <strong>Developers</strong>
section, where we will add our first <em>webhook</em> and create our
<em>restricted API keys</em>. We will get more familiar with the
dashboard and the API while we implement our demo shop below.
</p>
<div class="float"><a name="org6c6086a"></a>
<img src="img/stripe-payments-integration-dashboard-50.png" alt="Stripe Dashboard">

<div class="float-caption"><p><strong>Figure 2.1: </strong>The Initial Stripe Dashboard View</p></div></div>
<hr>
<a name="Creating-a-Webshop-in-React-with-Charges"></a>
<div class="header">
<p>
Next: <a href="#Placing-an-Order-With-Stripe" accesskey="n" rel="next">Placing an Order With Stripe</a>, Previous: <a href="#The-Basics-of-Stripe-Payments-Integration" accesskey="p" rel="prev">The Basics of Stripe Payments Integration</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Creating-a-Webshop-in-React-with-Charges-1"></a>
<h2 class="chapter">3 Creating a Webshop in React with Charges</h2>

<a name="index-webshop-creation"></a>
<a name="index-React-app_002c-Webshop"></a>
<a name="index-webshop-products"></a>
<a name="index-products-in-webshop"></a>
<p>Letâ€™s create a React Webshop with two products: a Banana and
Cucumber. What else would you want to buy in a webshop anyways,
right?
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Steps-for-Creating-a-Webshop" accesskey="1">Steps for Creating a Webshop</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Terminal-Commands-To-Build-the-React-App" accesskey="2">Terminal Commands To Build the React App</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Coding-the-App" accesskey="3">Coding the App</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Steps-for-Creating-a-Webshop"></a>
<div class="header">
<p>
Next: <a href="#Terminal-Commands-To-Build-the-React-App" accesskey="n" rel="next">Terminal Commands To Build the React App</a>, Up: <a href="#Creating-a-Webshop-in-React-with-Charges" accesskey="u" rel="up">Creating a Webshop in React with Charges</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Steps-for-Creating-a-Webshop-1"></a>
<h3 class="section">3.1 Steps for Creating a Webshop</h3>

<a name="index-create_002dreact_002dapp"></a>
<a name="index-axios"></a>
<a name="index-query_002dstring_002dobject"></a>
<a name="index-convert-objects-to-query-strings"></a>
<a name="index-Stripe-requests"></a>
<a name="index-React-Stripe-Elements"></a>
<a name="index-Stripe_002ejs"></a>
<a name="index-Stripe-Elements"></a>
<a name="index-credit-card_002c-secure-inputs"></a>
<a name="index-tokenization_002c-credit-card-data"></a>
<ul>
<li> We can use <a href="https://github.com/facebook/create-react-app">Create React App</a> to get started.
</li><li> We&rsquo;re going to use <a href="https://github.com/axios/axios">Axios</a> for HTTP requests;
</li><li> and <a href="https://www.npmjs.com/package/query-string-object">query-string-object</a> to convert objects to query strings for
Stripe requests.
</li><li> We will also need <a href="https://github.com/stripe/react-stripe-elements">React Stripe Elements</a>, which is a React wrapper
for Stripe.js and Stripe Elements. It adds secure credit card
inputs and sends the card&rsquo;s data for tokenization to the Stripe
API.
</li></ul>


<a name="index-credit-card-details_002c-raw"></a>
<a name="index-credit-card-security"></a>
<a name="index-WARNING_002c-raw-credit-card-details"></a>
<p><strong>WARNING:</strong> You should never send raw credit card details to your
own API, but let Stripe handle the credit card security for you.
</p>
<a name="index-token_002c-from-Stripe"></a>
<a name="index-credit-card-identification"></a>
<a name="index-identify-credit-card_002c-how"></a>
<p>You will be able to identify the card provided by the user using
the token you got from Stripe.
</p>
<a name="index-Stripe-Dashboard"></a>
<a name="index-Dashboard_002c-Stripe"></a>
<a name="index-API-key_002c-Stripe-Dashboard"></a>
<div class="float"><a name="org06b9b9b"></a>
<img src="img/stripe-payments-dashboard-api-key-50.png" alt="Stripe Dashboard API Key">

<div class="float-caption"><p><strong>Figure 3.1: </strong>Stripe Payments Dashboard API Key</p></div></div>
<hr>
<a name="Terminal-Commands-To-Build-the-React-App"></a>
<div class="header">
<p>
Next: <a href="#Coding-the-App" accesskey="n" rel="next">Coding the App</a>, Previous: <a href="#Steps-for-Creating-a-Webshop" accesskey="p" rel="prev">Steps for Creating a Webshop</a>, Up: <a href="#Creating-a-Webshop-in-React-with-Charges" accesskey="u" rel="up">Creating a Webshop in React with Charges</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Terminal-Commands-To-Build-the-React-App-1"></a>
<h3 class="section">3.2 Terminal Commands To Build the React App</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Create-the-React-App-and-Install-Stripe-Elements-and-Axios" accesskey="1">Create the React App and Install Stripe Elements and Axios</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Add-Stripejs-Code-to-indexhtml-File" accesskey="2">Add <code>Stripe.js</code> Code to <code>index.html</code> File</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Create-the-React-App-and-Install-Stripe-Elements-and-Axios"></a>
<div class="header">
<p>
Next: <a href="#Add-Stripejs-Code-to-indexhtml-File" accesskey="n" rel="next">Add <code>Stripejs</code> Code to <code>indexhtml</code> File</a>, Up: <a href="#Terminal-Commands-To-Build-the-React-App" accesskey="u" rel="up">Terminal Commands To Build the React App</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Create-the-React-App-and-Install-Stripe-Elements-and-Axios-1"></a>
<h4 class="subsection">3.2.1 Create the React App and Install Stripe Elements and Axios</h4>

<a name="index-webshop"></a>
<a name="index-front-end"></a>
<a name="index-React-app_002c-setup"></a>
<a name="index-create_002dreact_002dapp-1"></a>
<a name="index-npx"></a>
<a name="index-npm-install"></a>
<a name="index-axios-1"></a>
<a name="index-query_002dstring_002dobject-1"></a>
<a name="index-create_002dscript"></a>
<div class="float"><a name="org061880f"></a>
<div class="example">
<pre class="example">1  npx create-react-app webshop
2  cd webshop
3  npm install --save react-stripe-elements
4  npm install --save axios
5  npm install --save query-string-object
</pre></div>

<div class="float-caption"><p><strong>Listing 3.1: </strong>Create the Webshop Front End</p></div></div>
<hr>
<a name="Add-Stripejs-Code-to-indexhtml-File"></a>
<div class="header">
<p>
Previous: <a href="#Create-the-React-App-and-Install-Stripe-Elements-and-Axios" accesskey="p" rel="prev">Create the React App and Install Stripe Elements and Axios</a>, Up: <a href="#Terminal-Commands-To-Build-the-React-App" accesskey="u" rel="up">Terminal Commands To Build the React App</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Add-Stripe_002ejs-Code-to-index_002ehtml-File"></a>
<h4 class="subsection">3.2.2 Add <code>Stripe.js</code> Code to <code>index.html</code> File</h4>

<a name="index-Stripe_002ejs-1"></a>
<a name="index-index_002ehtml"></a>
<a name="index-_003cscript_003e_002e_002e_002e_003c_002fscript_003e"></a>
<p>After weâ€™re done with the preparations, we have to include
<samp>Stripe.js</samp> in our application.  Just add
</p><div class="example">
<pre class="example">&lt;script src=&quot;https://js.stripe.com/v3/&quot;&gt;&lt;/script&gt;
</pre></div>
<p>to the head of your <samp>index.html</samp>.
</p>
<hr>
<a name="Coding-the-App"></a>
<div class="header">
<p>
Previous: <a href="#Terminal-Commands-To-Build-the-React-App" accesskey="p" rel="prev">Terminal Commands To Build the React App</a>, Up: <a href="#Creating-a-Webshop-in-React-with-Charges" accesskey="u" rel="up">Creating a Webshop in React with Charges</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Coding-the-App-1"></a>
<h3 class="section">3.3 Coding the App</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Stripe-Object-in-Root-React-Component-Appjs" accesskey="1">Stripe Object in Root React Component <samp>App.js</samp></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Implementation-of-Shopjs-Component" accesskey="2">Implementation of <samp>Shop.js</samp> Component</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Explanation-of-Shopjs" accesskey="3">Explanation of <samp>Shop.js</samp></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#POST-Request-to-Stripe" accesskey="4">POST Request to Stripe</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Charge-a-Credit-Card-in-Shopjs" accesskey="5">Charge a Credit Card in <samp>Shop.js</samp></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Stripe-Object-in-Root-React-Component-Appjs"></a>
<div class="header">
<p>
Next: <a href="#Implementation-of-Shopjs-Component" accesskey="n" rel="next">Implementation of <samp>Shopjs</samp> Component</a>, Up: <a href="#Coding-the-App" accesskey="u" rel="up">Coding the App</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Stripe-Object-in-Root-React-Component-App_002ejs"></a>
<h4 class="subsection">3.3.1 Stripe Object in Root React Component <samp>App.js</samp></h4>

<a name="index-StripeProvider-component"></a>
<a name="index-_007ereact_002dstripe_002delements_007e"></a>
<a name="index-root-react-component"></a>
<a name="index-react-root-component"></a>
<a name="index-App_002ejs"></a>
<p>First, we have to add a <code>&lt;StripeProvider/&gt;</code> from
<code>react-stripe-elements</code> to our root React App component.
</p>
<a name="index-Stripe-object"></a>
<a name="index-props"></a>
<a name="index-react-props"></a>
<a name="index-public-access-key"></a>
<a name="index-access-key_002c-public"></a>
<a name="index-key_002c-public-access"></a>
<a name="index-apiKey"></a>
<a name="index-Dashboard"></a>
<a name="index-Developers-section_002c-Dashboard-1"></a>
<a name="index-API-keys"></a>
<a name="index-Dashboard-menu"></a>
<a name="index-Publishable-key"></a>
<p>This will give us access to the <a href="https://stripe.com/docs/stripe-js/reference#the-stripe-object">Stripe object</a>.  In the props, we
should pass a <strong>public access key</strong> (<code>apiKey</code>) which is found in the
dashboard&rsquo;s <strong>Developers</strong> section under the <em>API keys</em> menu as
<em>Publishable key</em>. (<a href="#org06b9b9b">Figure 3.1</a>)
</p>
<a name="index-App_002ejs-1"></a>
<a name="index-react_002dstripe_002delements"></a>
<a name="index-Elements"></a>
<a name="index-StripeProvider"></a>
<a name="index-apiKey-1"></a>
<div class="float"><a name="orgdc53676"></a>
<div class="example">
<pre class="example"> 1  // App.js
 2  import React from 'react'
 3  import {StripeProvider, Elements} from 'react-stripe-elements'
 4  import Shop from './Shop'
 5  
 6  const App = () =&gt; {
 7    return (
 8      &lt;StripeProvider apiKey=&quot;pk_test_xxxxxxxxxxxxxxxxxxxxxxxx&quot;&gt;
 9        &lt;Elements&gt;
10          &lt;Shop/&gt;
11        &lt;/Elements&gt;
12      &lt;/StripeProvider&gt;
13    )
14  }
</pre></div>

<div class="float-caption"><p><strong>Listing 3.2: </strong><code>StripeProvider</code> Component in Root Component</p></div></div>
<p>The <code>&lt;Shop/&gt;</code> is the implementation of our shop form as you can see
from <code>import Shop from './Shop'</code>.  We&rsquo;ll go into the details later.
</p>
<hr>
<a name="Implementation-of-Shopjs-Component"></a>
<div class="header">
<p>
Next: <a href="#Explanation-of-Shopjs" accesskey="n" rel="next">Explanation of <samp>Shopjs</samp></a>, Previous: <a href="#Stripe-Object-in-Root-React-Component-Appjs" accesskey="p" rel="prev">Stripe Object in Root React Component <samp>Appjs</samp></a>, Up: <a href="#Coding-the-App" accesskey="u" rel="up">Coding the App</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Implementation-of-Shop_002ejs-Component"></a>
<h4 class="subsection">3.3.2 Implementation of <samp>Shop.js</samp> Component</h4>

<a name="index-Elements-1"></a>
<a name="index-injectStripe"></a>
<a name="index-Shop_002ejs"></a>
<p>As you can see the <code>&lt;Shop/&gt;</code> is wrapped in <code>&lt;Elements&gt;</code> imported
from <samp>react-stripe-elements</samp> so that you can use
<code>injectStripe</code> in your components. To shed some light on this,
let&rsquo;s take a look at our implementation in <samp>Shop.js</samp>.
</p>
<a name="index-Shop_002ejs-1"></a>
<div class="example">
<pre class="example">  1   // Shop.js
  2  import React, { Component } from 'react'
  3  import { CardElement } from 'react-stripe-elements'
  4  import PropTypes from 'prop-types'
  5  import axios from 'axios'
  6  import qs from 'query-string-object'
  7  
  8  const prices = {
  9    banana: 150,
 10    cucumber: 100
 11  }
 12  
 13  class Shop extends Component {
 14    constructor(props) {
 15      super(props)
 16      this.state = {
 17        fetching: false,
 18        cart: {
 19          banana: 0,
 20          cucumber: 0
 21        }
 22      }
 23      this.handleCartChange = this.handleCartChange.bind(this)
 24      this.handleCartReset = this.handleCartReset.bind(this)
 25      this.handleSubmit = this.handleSubmit.bind(this)
 26    }
 27  
 28    handleCartChange(evt) {
 29      evt.preventDefault()
 30      const cart = this.state.cart
 31      cart[evt.target.name]+= parseInt(evt.target.value)
 32      this.setState({cart})
 33    }
 34  
 35    handleCartReset(evt) {
 36      evt.preventDefault()
 37      this.setState({cart:{banana: 0, cucumber: 0}})
 38    }
 39  
 40    handleSubmit(evt) {
 41      // TODO
 42    }
 43  
 44    render () {
 45      const cart = this.state.cart
 46      const fetching = this.state.fetching
 47      return (
 48        &lt;form onSubmit={this.handleSubmit}
 49              style={{width: '550px', margin: '20px',
 50                      padding: '10px', border: '2px solid lightseagreen',
 51                      borderRadius: '10px'}}&gt;
 52          &lt;div&gt;
 53            Banana {(prices.banana / 100).toLocaleString('en-US',
 54                   {style: 'currency', currency: 'usd'})}:
 55            &lt;div&gt;
 56              &lt;button name=&quot;banana&quot; value={1}
 57                 onClick={this.handleCartChange}&gt;
 58                 +
 59              &lt;/button&gt;
 60              &lt;button name=&quot;banana&quot; value={-1}
 61                 onClick={this.handleCartChange}
 62                 disabled={cart.banana &lt;= 0}&gt;
 63                 -
 64              &lt;/button&gt;
 65              {cart.banana}
 66            &lt;/div&gt;
 67          &lt;/div&gt;
 68          &lt;div&gt;
 69            Cucumber {(prices.cucumber / 100).toLocaleString('en-US',
 70                     {style: 'currency', currency: 'usd'})}:
 71            &lt;div&gt;
 72              &lt;button name=&quot;cucumber&quot; value={1}
 73                 onClick={this.handleCartChange}&gt;
 74                 +
 75              &lt;/button&gt;
 76              &lt;button name=&quot;cucumber&quot; value={-1}
 77                 onClick={this.handleCartChange} disabled={cart.cucumber &lt;= 0}&gt;
 78                 -
 79              &lt;/button&gt;
 80              {cart.cucumber}
 81            &lt;/div&gt;
 82          &lt;/div&gt;
 83          &lt;button onClick={this.handleCartReset}&gt; Reset Cart &lt;/button&gt;
 84          &lt;div style={{width: '450px', margin: '10px',
 85                       padding: '5px', border: '2px solid green',
 86                       borderRadius: '10px'}}&gt;
 87             &lt;CardElement style={{base: {fontSize: '18px'}}}/&gt;
 88          &lt;/div&gt;
 89          {!fetching
 90            ? &lt;button type=&quot;submit&quot;
 91               disabled={cart.banana === 0 &amp;&amp;
 92               cart.cucumber === 0}&gt;Purchase&lt;/button&gt;
 93            : 'Purchasing...'
 94          }
 95          Price:
 96            {((cart.banana * prices.banana + cart.cucumber * prices.cucumber) / 100)
 97                 .toLocaleString('en-US',
 98                {style: 'currency', currency: 'usd'})}
 99        &lt;/form&gt;
100      )
101    }
102  }
103  
104  Shop.propTypes = {
105    stripe: PropTypes.shape({
106      createToken: PropTypes.func.isRequired
107    }).isRequired
108  }
</pre></div>

<hr>
<a name="Explanation-of-Shopjs"></a>
<div class="header">
<p>
Next: <a href="#POST-Request-to-Stripe" accesskey="n" rel="next">POST Request to Stripe</a>, Previous: <a href="#Implementation-of-Shopjs-Component" accesskey="p" rel="prev">Implementation of <samp>Shopjs</samp> Component</a>, Up: <a href="#Coding-the-App" accesskey="u" rel="up">Coding the App</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Explanation-of-Shop_002ejs"></a>
<h4 class="subsection">3.3.3 Explanation of <samp>Shop.js</samp></h4>

<a name="Simple-React-Form"></a>
<h3 class="heading">Simple React Form</h3>

<a name="index-React-form"></a>
<a name="index-form_002c-React"></a>
<p>The <code>Shop</code> is a simple React form with purchasable elements:
&lsquo;<samp>Banana</samp>&rsquo; and &lsquo;<samp>Cucumber</samp>&rsquo;, and with a quantity &lsquo;<samp>increase/decrease</samp>&rsquo;
button for each. Clicking the buttons will change their respective
amount in <code>this.state.cart</code>.
</p>
<a name="Presentation"></a>
<h4 class="subheading">Presentation</h4>

<p>There is a &lsquo;<samp>submit</samp>&rsquo; button below, and the current total price of
the cart is printed at the very bottom of the form.  Price will
expect the prices in cents, so we store them as cents, but of
course, we want to present them to the user in dollars.  We prefer
them to be shown to the second decimal place, e.g. $2.50 instead
of $2.5. To achieve this, we can use the built-in
<code>toLocaleString()</code> function to format the prices.
</p>
<a name="Stripe-Form-for-Card-Details_003a-_003cCardElement_002f_003e"></a>
<h3 class="heading">Stripe Form for Card Details: <code>&lt;CardElement/&gt;</code></h3>

<a name="index-Stripe_002c-in-React-form"></a>
<a name="index-Stripe-form-element"></a>
<a name="index-credit-card_002c-details"></a>
<a name="index-CardElement"></a>
<a name="index-react_002dstripe_002delements-1"></a>
<a name="index-css_002c-form-style"></a>
<p>Now comes the Stripe-specific part: we need to add a form element
so users can enter their card details. To achieve this, we only
need to add <code>&lt;CardElement/&gt;</code> from
<samp>react-stripe-elements</samp> and that&rsquo;s it. I&rsquo;ve also added a
bit of low effort inline &lsquo;<samp>css</samp>&rsquo; to make this shop at least somewhat
pleasing to the eye.
</p>
<a name="Pass-Sripe-Object-As-Prop-to-the-Shop"></a>
<h3 class="heading">Pass Sripe Object As Prop to the <code>Shop</code></h3>

<a name="index-injectStripe-hoc"></a>
<a name="index-higher_002dorder_002dcomponent_002c-injectStripe"></a>
<a name="index-Stripe-object_002c-as-prop"></a>
<a name="index-Shop-component"></a>
<a name="index-createToken_0028_0029-function"></a>
<a name="index-handleSubmit"></a>
<a name="index-credit-card_002c-tokenized"></a>
<a name="index-tokenize_002c-credit-card"></a>
<a name="index-credit-card_002c-charge"></a>
<p>We also need to use the <code>injectStripe</code> Higher-Order-Component in
order to pass the <code>Stripe</code> object as a prop to the <code>&lt;Shop/&gt;</code>
component, so we can call Stripe&rsquo;s <code>createToken()</code> function in
<code>handleSubmit</code> to tokenize the user&rsquo;s card, so they can be
charged.  Once we receive the tokenized card from Stripe, we are
ready to charge it.
</p>
<a name="index-Shop_002ejs-2"></a>
<a name="index-injectStripe-1"></a>
<a name="index-react_002dstripe_002delements-2"></a>
<a name="index-injectStripe_0028Shop_0029-function"></a>
<div class="float"><a name="orgf8b82a0"></a>
<div class="example">
<pre class="example">1  // Shop.js
2  import { injectStripe } from 'react-stripe-elements'
3  export default injectStripe(Shop)
</pre></div>

<div class="float-caption"><p><strong>Listing 3.3: </strong>Inject Stripe from react-stripe-elements</p></div></div>
<hr>
<a name="POST-Request-to-Stripe"></a>
<div class="header">
<p>
Next: <a href="#Charge-a-Credit-Card-in-Shopjs" accesskey="n" rel="next">Charge a Credit Card in <samp>Shopjs</samp></a>, Previous: <a href="#Explanation-of-Shopjs" accesskey="p" rel="prev">Explanation of <samp>Shopjs</samp></a>, Up: <a href="#Coding-the-App" accesskey="u" rel="up">Coding the App</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="POST-Request-to-Stripe-1"></a>
<h4 class="subsection">3.3.4 POST Request to Stripe</h4>

<a name="index-POST-request_002c-credit-card"></a>
<a name="index-credit-card_002c-charge_002c-POST-request"></a>
<p>For now let&rsquo;s just keep it simple and charge the card by sending a
<code>POST</code> request to &lsquo;<samp>https://api.stripe.com/v1/charges</samp>&rsquo; with
specifying the payment <code>source</code> (this is the token id), the charge
<code>amount</code> (of the charge) and the <code>currency</code> as described in the
Stripe API.
</p>
<a name="index-API-key_002c-create-restricted"></a>
<a name="index-authorization"></a>
<a name="index-Dashboard-1"></a>
<a name="index-Developers-menu"></a>
<p>We need to send the API key in the header for authorization. We
can create a restricted API key on the dashboard in the
<strong>Developers</strong> menu. Set the permission for charges to &ldquo;Read and
write&rdquo; as shown in <a href="#org2ac7407">Figure 3.2</a>, below.
</p>
<p><strong>Do not forget:. You should never use your swiss army Secret key
on the client!</strong>
</p>
<div class="float"><a name="org2ac7407"></a>
<img src="img/Stripe-Dashboard-API-Key-Restricted-50.png" alt="img/Stripe-Dashboard-API-Key-Restricted-50">

<div class="float-caption"><p><strong>Figure 3.2: </strong>Restricted API Key in the Dashboard Developers Menu</p></div></div>
<hr>
<a name="Charge-a-Credit-Card-in-Shopjs"></a>
<div class="header">
<p>
Previous: <a href="#POST-Request-to-Stripe" accesskey="p" rel="prev">POST Request to Stripe</a>, Up: <a href="#Coding-the-App" accesskey="u" rel="up">Coding the App</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Charge-a-Credit-Card-in-Shop_002ejs"></a>
<h4 class="subsection">3.3.5 Charge a Credit Card in <samp>Shop.js</samp></h4>

<a name="index-Shop_002ejs-3"></a>
<a name="index-Shop-component_002c-charge-credit-card"></a>
<a name="index-credit-card_002c-charge-1"></a>
<a name="index-axios-2"></a>
<a name="index-post_002c-axios"></a>
<a name="index-props_002estripe_002ecreateToken_0028_0029"></a>
<div class="example">
<pre class="example"> 1  // Shop.js
 2  // ...
 3  const stripeAuthHeader = {
 4    'Content-Type': 'application/x-www-form-urlencoded',
 5    'Authorization': `Bearer rk_test_xxxxxxxxxxxxxxxxxxxxxxxx`
 6  }
 7  
 8  class Shop extends Component {
 9    // ...
10    handleSubmit(evt) {
11      evt.preventDefault()
12      this.setState({fetching: true})
13      const cart = this.state.cart
14  
15      this.props.stripe.createToken().then(({token}) =&gt; {
16          const price =
17             cart.banana * prices.banana + cart.cucumber * prices.cucumber
18          axios.post(`https://api.stripe.com/v1/charges`,
19          qs.stringify({
20            source: token.id,
21            amount: price,
22            currency: 'usd'
23          }),
24          { headers: stripeAuthHeader })
25          .then((resp) =&gt; {
26            this.setState({fetching: false})
27            alert(`Thank you for your purchase! You card has been charged with: \
28              ${(resp.data.amount / 100).toLocaleString('en-US',
29              {style: 'currency', currency: 'usd'})}`)
30          })
31          .catch(error =&gt; {
32            this.setState({fetching: false})
33            console.log(error)
34          })
35      }).catch(error =&gt; {
36        this.setState({fetching: false})
37        console.log(error)
38      })
39    }
40    // ...
41  }
</pre></div>

<a name="index-testing"></a>
<a name="index-international-cards"></a>
<p>For testing purposes you can use these <a href="https://stripe.com/docs/testing#international-cards">international cards</a> provided by Stripe.
</p>
<hr>
<a name="Placing-an-Order-With-Stripe"></a>
<div class="header">
<p>
Next: <a href="#Setting-up-Stripe-Webhooks-to-Verify-Payments" accesskey="n" rel="next">Setting up Stripe Webhooks to Verify Payments</a>, Previous: <a href="#Creating-a-Webshop-in-React-with-Charges" accesskey="p" rel="prev">Creating a Webshop in React with Charges</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Placing-an-Order-With-Stripe-1"></a>
<h2 class="chapter">4 Placing an Order With Stripe</h2>

<a name="index-products-and-orders"></a>
<a name="index-orders-and-products"></a>
<p>Looks good; we can already create tokens from cards and charge them,
but how should we know who bought what and where should we send the
package?  Thats where products and orders come in.
</p>
<a name="index-order_002c-create"></a>
<a name="index-server_002c-set-up"></a>
<a name="index-API_002c-expose-to-handle-order"></a>
<a name="index-webhook_002c-to-process-order"></a>
<p>Implementing a simple charging method is a good start, but we will
need to take it a step further to create orders. To do so, we have
to set up a server and expose an API which handles those orders and
accepts webhooks from Stripe to process them once they got paid.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Set-Up-an-Express-Server" accesskey="1">Set Up an Express Server</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Handle-Orders-on-the-Front-End" accesskey="2">Handle Orders on the Front End</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Set-Up-an-Express-Server"></a>
<div class="header">
<p>
Next: <a href="#Handle-Orders-on-the-Front-End" accesskey="n" rel="next">Handle Orders on the Front End</a>, Up: <a href="#Placing-an-Order-With-Stripe" accesskey="u" rel="up">Placing an Order With Stripe</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Set-Up-an-Express-Server-1"></a>
<h3 class="section">4.1 Set Up an Express Server</h3>

<a name="index-express-server_002c-set-up"></a>
<a name="index-routes_002c-API"></a>
<a name="index-npm"></a>
<a name="index-back-end"></a>
<a name="index-node-packages_002c-other-needed"></a>
<a name="index-express"></a>
<a name="index-body_002dparser_002c-node"></a>
<a name="index-cors_002c-node"></a>
<a name="index-helmet_002c-node"></a>
<p>We will use <a href="https://expressjs.com/">express</a> to handle the routes of our API. You can find a
list below of a couple of other node packages to get started. Let&rsquo;s
create a new root folder and get started.
</p><div class="example">
<pre class="example">npm install express stripe body-parser cors helmet
</pre></div>

<a name="index-CORS"></a>
<a name="index-Helmet"></a>
<a name="index-security-headers"></a>
<a name="index-headers_002c-security"></a>
<p>The skeleton is a simple express &ldquo;Hello World&rdquo; using <a href="https://www.npmjs.com/package/cors">CORS</a> so that
the browser won&rsquo;t panic when we try to reach our PI server that
resides and <a href="https://www.npmjs.com/package/helmet">Helmet</a> to set a bunch of security headers automatically
for us.
</p>
<a name="index-index_002ejs-1"></a>
<a name="index-server-code_002c-skeleton"></a>
<div class="float"><a name="org8f4cc4e"></a>
<div class="example">
<pre class="example"> 1  // index.js
 2  const express = require('express')
 3  const helmet = require('helmet')
 4  const cors = require('cors')
 5  const app = express()
 6  const port = 3001
 7  
 8  app.use(helmet())
 9  
10  app.use(cors({
11    origin: [/http:\/\/localhost:\d+$/],
12    allowedHeaders: ['Content-Type', 'Authorization'],
13    credentials: true
14  }))
15  
16  app.get('/api/', (req, res) =&gt; res.send({ version: '1.0' }))
17  
18  app.listen(port, () =&gt; console.log(`Example app listening on port ${port}!`))
</pre></div>

<div class="float-caption"><p><strong>Listing 4.1: </strong>Initial Framework for Server <code>index.js</code></p></div></div>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Access-Stripe-in-Server-indexjs" accesskey="1">Access Stripe in Server <code>index.js</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Stripe-Customers" accesskey="2">Stripe Customers</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Use-Card-Token-as-Source" accesskey="3">Use Card Token as &lsquo;<samp>Source</samp>&rsquo;</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Implement-CC-Charges-in-indexjs" accesskey="4">Implement CC Charges in <code>index.js</code></a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Access-Stripe-in-Server-indexjs"></a>
<div class="header">
<p>
Next: <a href="#Stripe-Customers" accesskey="n" rel="next">Stripe Customers</a>, Up: <a href="#Set-Up-an-Express-Server" accesskey="u" rel="up">Set Up an Express Server</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Access-Stripe-in-Server-index_002ejs"></a>
<h4 class="subsection">4.1.1 Access Stripe in Server <code>index.js</code></h4>

<a name="index-index_002ejs"></a>
<a name="index-Stripe_002c-access-from-server"></a>
<a name="index-secret-key"></a>
<a name="index-Dashboard-Developers-API-keys"></a>
<a name="index-stripe_002eorders_002ecreate_0028_0029-function"></a>
<p>In order to access Stripe, <code>require</code> <samp>Stripe.js</samp> and
call it straight away with your Secret Key (you can find it in
&lsquo;<samp>dashboard-&gt;Developers-&gt;Api keys</samp>&rsquo;), we will use
<code>stripe.orders.create()</code> for passing the data we receive when the
client calls our server to place an order.
</p>
<hr>
<a name="Stripe-Customers"></a>
<div class="header">
<p>
Next: <a href="#Use-Card-Token-as-Source" accesskey="n" rel="next">Use Card Token as &lsquo;<samp>Source</samp>&rsquo;</a>, Previous: <a href="#Access-Stripe-in-Server-indexjs" accesskey="p" rel="prev">Access Stripe in Server <code>indexjs</code></a>, Up: <a href="#Set-Up-an-Express-Server" accesskey="u" rel="up">Set Up an Express Server</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Stripe-Customers-1"></a>
<h4 class="subsection">4.1.2 Stripe Customers</h4>

<a name="index-Stripe-Customer"></a>
<a name="index-charge-a-customer"></a>
<a name="index-Source"></a>
<a name="index-Card-Token-ID"></a>
<p>The orders will not be paid automatically. To charge the customer
we can either use a &lsquo;<samp>Source</samp>&rsquo; directly such as a <strong>Card Token ID</strong> or
we can create a <a href="https://stripe.com/docs/api/customers/create">Stripe Customer</a>.
</p>
<a name="index-Stripe-Customer_002c-benefit-of-using"></a>
<a name="index-charges_002c-multiple"></a>
<a name="index-charges_002c-recurring"></a>
<a name="index-data_002c-store-on-Stripe"></a>
<p>The added benefit of creating a Stripe customer is that we can
track multiple charges, or create recurring charges for them and
also instruct Stripe to store the shipping data and other
necessary information to fulfill the order.
</p>
<a name="index-Customer_002c-create"></a>
<a name="index-Card-Token"></a>
<a name="index-data_002c-shipping"></a>
<a name="index-discount"></a>
<a name="index-single-click-shopping"></a>
<a name="index-list-orders"></a>
<a name="index-orders_002c-list-on-UI"></a>
<p>You probably want to create Customers from Card Tokens and
shipping data even when your application already handles
users. This way you can attach permanent or seasonal discount to
those Customers, allow them to shop any time with a single click
and <a href="https://stripe.com/docs/api/orders/list">list their orders</a> on your UI.
</p>
<hr>
<a name="Use-Card-Token-as-Source"></a>
<div class="header">
<p>
Next: <a href="#Implement-CC-Charges-in-indexjs" accesskey="n" rel="next">Implement CC Charges in <code>indexjs</code></a>, Previous: <a href="#Stripe-Customers" accesskey="p" rel="prev">Stripe Customers</a>, Up: <a href="#Set-Up-an-Express-Server" accesskey="u" rel="up">Set Up an Express Server</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Use-Card-Token-as-Source-1"></a>
<h4 class="subsection">4.1.3 Use Card Token as &lsquo;<samp>Source</samp>&rsquo;</h4>

<a name="index-Card-Token-1"></a>
<a name="index-Source-1"></a>
<a name="index-stripe_002eorders_002epay_0028_0029-function"></a>
<p>For now let&rsquo;s keep it simple anyway and use the Card Token as our
&lsquo;<samp>Source</samp>&rsquo; calling <code>stripe.orders.pay()</code> once the order is
successfully created.
</p>
<a name="index-separate-order-from-payment"></a>
<a name="index-endpoints_002c-different-for-order-and-payment"></a>
<p>In a real-world scenario, you probably want to separate the order
creation from payment by exposing them on different endpoints, so
if the payment fails the Client can try again later without having
to recreate the order. However, we still have a lot to cover, so
let&rsquo;s not overcomplicate things.
</p>
<hr>
<a name="Implement-CC-Charges-in-indexjs"></a>
<div class="header">
<p>
Previous: <a href="#Use-Card-Token-as-Source" accesskey="p" rel="prev">Use Card Token as &lsquo;<samp>Source</samp>&rsquo;</a>, Up: <a href="#Set-Up-an-Express-Server" accesskey="u" rel="up">Set Up an Express Server</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Implement-CC-Charges-in-index_002ejs"></a>
<h4 class="subsection">4.1.4 Implement CC Charges in <code>index.js</code></h4>

<a name="index-index_002ejs-2"></a>
<a name="index-post_002c-order"></a>
<a name="index-create-Stripe-order"></a>
<a name="index-order_002c-create-Stripe"></a>
<div class="float"><a name="orgd4638cf"></a>
<div class="example">
<pre class="example"> 1  // index.js
 2  const stripe = require('stripe')('sk_test_xxxxxxxxxxxxxxxxxxxxxx')
 3  
 4  app.post('/api/shop/order', async (req, res) =&gt; {
 5    const order = req.body.order
 6    const source = req.body.source
 7    try {
 8      const stripeOrder = await stripe.orders.create(order)
 9      console.log(`Order created: ${stripeOrder.id}`)
10      await stripe.orders.pay(stripeOrder.id, {source})
11    } catch (err) {
12      // Handle stripe errors here: No such coupon, sku, ect
13      console.log(`Order error: ${err}`)
14      return res.sendStatus(404)
15    }
16    return res.sendStatus(200)
17  })
</pre></div>

<div class="float-caption"><p><strong>Listing 4.2: </strong>App Post Function</p></div></div>
<hr>
<a name="Handle-Orders-on-the-Front-End"></a>
<div class="header">
<p>
Previous: <a href="#Set-Up-an-Express-Server" accesskey="p" rel="prev">Set Up an Express Server</a>, Up: <a href="#Placing-an-Order-With-Stripe" accesskey="u" rel="up">Placing an Order With Stripe</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Handle-Orders-on-the-Front-End-1"></a>
<h3 class="section">4.2 Handle Orders on the Front End</h3>

<a name="index-front-end_002c-order-handling"></a>
<a name="index-UI_002c-order-handling"></a>
<a name="index-orders_002c-handle-on-the-UI"></a>
<p>Now we&rsquo;re able to handle orders on the backend, but we also need
to implement this on the UI.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Implement-State-of-Shop-Component" accesskey="1">Implement State of Shop Component</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Create-Input-Fields" accesskey="2">Create Input Fields</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Create-Products-and-Assign-SKUs" accesskey="3">Create Products and Assign SKUs</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Add-Products-to-the-Webshop" accesskey="4">Add Products to the Webshop</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Send-Orders-to-Stripe-API-on-Submit" accesskey="5">Send Orders to Stripe API on Submit</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Create-a-Coupon-for-Testing" accesskey="6">Create a Coupon for Testing</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Implement-State-of-Shop-Component"></a>
<div class="header">
<p>
Next: <a href="#Create-Input-Fields" accesskey="n" rel="next">Create Input Fields</a>, Up: <a href="#Handle-Orders-on-the-Front-End" accesskey="u" rel="up">Handle Orders on the Front End</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Implement-State-of-Shop-Component-1"></a>
<h4 class="subsection">4.2.1 Implement State of Shop Component</h4>

<a name="index-state_002c-implement-Shop-Component"></a>
<a name="index-object_002c-state"></a>
<a name="index-Stripe-API"></a>
<a name="index-API-1"></a>
<a name="index-Shop-component-1"></a>
<a name="index-Shop-object"></a>
<p>First, let&rsquo;s implement the state of the <code>&lt;Shop/&gt;</code> as an object the
Stripe API expects.
</p>
<a name="index-order-request_002c-should-look-like"></a>
<a name="index-address-object"></a>
<a name="index-fields_002c-address-object"></a>
<a name="index-coupon"></a>
<p>You can find out how an order request should look like <a href="https://stripe.com/docs/api/orders/create">here</a>. We&rsquo;ll
need an &lsquo;<samp>address</samp>&rsquo; object with &lsquo;<samp>line1</samp>&rsquo;, &lsquo;<samp>city</samp>&rsquo;, &lsquo;<samp>state</samp>&rsquo;, &lsquo;<samp>country</samp>&rsquo;,
&lsquo;<samp>postal_code</samp>&rsquo; fields, a &lsquo;<samp>name</samp>&rsquo;, an &lsquo;<samp>email</samp>&rsquo; and a &lsquo;<samp>coupon</samp>&rsquo; field,
to get our customers ready for coupon hunting.
</p>
<a name="index-Shop_002ejs-4"></a>
<div class="example">
<pre class="example"> 1  // Shop.js
 2  class Shop extends Component {
 3    constructor(props) {
 4      super(props)
 5      this.state = {
 6        fetching: false,
 7        cart: {
 8          banana: 0,
 9          cucumber: 0
10        },
11        coupon: '',
12        email: '',
13        name: '',
14        address : {
15          line1: '',
16          city: '',
17          state: '',
18          country: '',
19          postal_code: ''
20        }
21      }
22      this.handleCartChange = this.handleCartChange.bindthis)
23      this.handleCartReset = this.handleCartReset.bind(this)
24      this.handleAddressChange = this.handleAddressChange.bind(this)
25      this.handleChange = this.handleChange.bind(this)
26      this.handleSubmit = this.handleSubmit.bind(this)
27    }
28  
29    handleChange(evt) {
30      evt.preventDefault()
31      this.setState({[evt.target.name]: evt.target.value})
32    }
33  
34    handleAddressChange(evt) {
35      evt.preventDefault()
36      const address = this.state.address
37      address[evt.target.name] = evt.target.value
38      this.setState({address})
39    }
40    // ...
41  }
</pre></div>

<hr>
<a name="Create-Input-Fields"></a>
<div class="header">
<p>
Next: <a href="#Create-Products-and-Assign-SKUs" accesskey="n" rel="next">Create Products and Assign SKUs</a>, Previous: <a href="#Implement-State-of-Shop-Component" accesskey="p" rel="prev">Implement State of Shop Component</a>, Up: <a href="#Handle-Orders-on-the-Front-End" accesskey="u" rel="up">Handle Orders on the Front End</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Create-Input-Fields-1"></a>
<h4 class="subsection">4.2.2 Create Input Fields</h4>

<a name="index-input-fields_002c-create"></a>
<a name="index-submit-button_002c-disable"></a>
<p>Now we are ready to create the input fields. We should, of course,
disable the submit button when the input fields are empty. Just
the usual deal.
</p>
<a name="index-Shop_002ejs-5"></a>
<div class="example">
<pre class="example"> 1  // Shop.js
 2  render () {
 3    const state = this.state
 4    const fetching = state.fetching
 5    const cart = state.cart
 6    const address = state.address
 7    const submittable =
 8       (cart.banana !== 0 || cart.cucumber !== 0) &amp;&amp;
 9       state.email &amp;&amp;
10       state.name &amp;&amp;
11       address.line1 &amp;&amp;
12       address.city &amp;&amp;
13       address.state &amp;&amp;
14       address.country &amp;&amp;
15       address.postal_code
16    return (
17  // ...
18      &lt;div&gt;
19         Name: &lt;input type=&quot;text&quot; name=&quot;name&quot;
20         onChange={this.handleChange}/&gt;
21      &lt;/div&gt;
22      &lt;div&gt;
23         Email: &lt;input  type=&quot;text&quot; name=&quot;email&quot;
24         onChange={this.handleChange}/&gt;
25      &lt;/div&gt;
26      &lt;div&gt;
27         Address Line: &lt;input  type=&quot;text&quot; name=&quot;line1&quot;
28         onChange={this.handleAddressChange}/&gt;
29      &lt;/div&gt;
30      &lt;div&gt;
31         City: &lt;input  type=&quot;text&quot; name=&quot;city&quot;
32         onChange={this.handleAddressChange}/&gt;
33      &lt;/div&gt;
34      &lt;div&gt;
35         State: &lt;input  type=&quot;text&quot; name=&quot;state&quot;
36         onChange={this.handleAddressChange}/&gt;
37      &lt;/div&gt;
38      &lt;div&gt;
39         Country: &lt;input  type=&quot;text&quot; name=&quot;country&quot;
40         onChange={this.handleAddressChange}/&gt;
41      &lt;/div&gt;
42      &lt;div&gt;
43         Postal Code: &lt;input  type=&quot;text&quot; name=&quot;postal_code&quot;
44         onChange={this.handleAddressChange}/&gt;
45      &lt;/div&gt;
46      &lt;div&gt;
47         Coupon Code: &lt;input  type=&quot;text&quot; name=&quot;coupon&quot;
48         onChange={this.handleChange}/&gt;
49      &lt;/div&gt;
50      {!fetching
51        ? &lt;button type=&quot;submit&quot; disabled={!submittable}&gt;Purchase&lt;/button&gt;
52        : 'Purchasing...'}
53  // ...
</pre></div>

<a name="index-purchasable-items_002c-define"></a>
<a name="index-Stock-Keeping-Unit-_0028SKU_0029"></a>
<a name="index-SKU_002c-define-in-Stripe"></a>
<a name="index-Dashboard_002c-define-SKU-in-Stripe"></a>
<p>We also have to define purchasable items.  These items will be
identified by a <a href="https://en.wikipedia.org/wiki/Stock_keeping_unit">Stock Keeping Unit</a> by Stripe, which can be created
on the dashboard as well.
</p>
<hr>
<a name="Create-Products-and-Assign-SKUs"></a>
<div class="header">
<p>
Next: <a href="#Add-Products-to-the-Webshop" accesskey="n" rel="next">Add Products to the Webshop</a>, Previous: <a href="#Create-Input-Fields" accesskey="p" rel="prev">Create Input Fields</a>, Up: <a href="#Handle-Orders-on-the-Front-End" accesskey="u" rel="up">Handle Orders on the Front End</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Create-Products-and-Assign-SKUs-1"></a>
<h4 class="subsection">4.2.3 Create Products and Assign SKUs</h4>

<a name="index-products_002c-create"></a>
<a name="index-SKU_002c-assign"></a>
<a name="index-Inventory-group"></a>
<a name="index-Dashboard-2"></a>
<p>First, we have to create the Products (&lsquo;<samp>Banana</samp>&rsquo; and &lsquo;<samp>Cucumber</samp>&rsquo; on
&lsquo;<samp>dashboard-&gt;Orders-&gt;Products</samp>&rsquo;) and then assign an SKU to them
(click on the created product and &lsquo;<samp>Add SKU</samp>&rsquo; in the <strong>Inventory</strong>
group). An SKU specifies the products including its properties -
size, color, quantity, and prices -, so a product can have
multiple SKUs.
</p>
<div class="float"><a name="org1bb42b3"></a>
<img src="img/stripe-payments-dashboard-banana-product-creation-50.png" alt="img/stripe-payments-dashboard-banana-product-creation-50">

<div class="float-caption"><p><strong>Figure 4.1: </strong>Create a Product</p></div></div>
<div class="float"><a name="orgfb1e238"></a>
<img src="img/Stripe-Payments-Dashboard-Stock-Keeping-Unit-50.png" alt="img/Stripe-Payments-Dashboard-Stock-Keeping-Unit-50">

<div class="float-caption"><p><strong>Figure 4.2: </strong>Create a SKU</p></div></div>
<hr>
<a name="Add-Products-to-the-Webshop"></a>
<div class="header">
<p>
Next: <a href="#Send-Orders-to-Stripe-API-on-Submit" accesskey="n" rel="next">Send Orders to Stripe API on Submit</a>, Previous: <a href="#Create-Products-and-Assign-SKUs" accesskey="p" rel="prev">Create Products and Assign SKUs</a>, Up: <a href="#Handle-Orders-on-the-Front-End" accesskey="u" rel="up">Handle Orders on the Front End</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Add-Products-to-the-Webshop-1"></a>
<h4 class="subsection">4.2.4 Add Products to the Webshop</h4>

<a name="index-Webshop_002c-add-products-to"></a>
<a name="index-parse-order"></a>
<a name="index-order_002c-parse"></a>
<p>After we created our products and assigned SKUs to them, we add
them to the webshop so we can parse up the order.
</p>
<a name="index-Shop_002ejs-6"></a>
<div class="example">
<pre class="example">1  // Shop.js
2  const skus = {
3    banana: 1,
4    cucumber: 2
5  }
</pre></div>

<hr>
<a name="Send-Orders-to-Stripe-API-on-Submit"></a>
<div class="header">
<p>
Next: <a href="#Create-a-Coupon-for-Testing" accesskey="n" rel="next">Create a Coupon for Testing</a>, Previous: <a href="#Add-Products-to-the-Webshop" accesskey="p" rel="prev">Add Products to the Webshop</a>, Up: <a href="#Handle-Orders-on-the-Front-End" accesskey="u" rel="up">Handle Orders on the Front End</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Send-Orders-to-Stripe-API-on-Submit-1"></a>
<h4 class="subsection">4.2.5 Send Orders to Stripe API on Submit</h4>

<a name="index-orders_002c-send"></a>
<a name="index-send-orders"></a>
<a name="index-API_002c-send-orders-to"></a>
<a name="index-total-price-of-orders_002c-automatic-calculation"></a>
<p>We are ready to send orders to our express API on submit. We do
not have to calculate the total price of orders from now
on. Stripe can sum it up for us, based on the SKUs, quantities,
and coupons.
</p>
<a name="index-Shop_002ejs-7"></a>
<a name="index-post_002c-axios-1"></a>
<a name="index-order_002c-send-in-code"></a>
<div class="example">
<pre class="example"> 1  // Shop.js
 2  handleSubmit(evt) {
 3    evt.preventDefault()
 4    this.setState({fetching: true})
 5    const state = this.state
 6    const cart = state.cart
 7  
 8    this.props.stripe.createToken({name: state.name}).then(({token}) =&gt; {
 9      // Create order
10      const order = {
11        currency: 'usd',
12        items: Object.keys(cart).filter((name) =&gt; cart[name] &gt; 0
13           ? true : false).map(name =&gt; {
14          return {
15            type: 'sku',
16            parent: skus[name],
17            quantity: cart[name]
18          }
19        }),
20        email: state.email,
21        shipping: {
22          name: state.name,
23          address: state.address
24        }
25      }
26      // Add coupon if given
27      if (state.coupon) {
28        order.coupon = state.coupon
29      }
30      // Send order
31      axios.post(`http://localhost:3001/api/shop/order`, {order, source: token.id})
32      .then(() =&gt; {
33        this.setState({fetching: false})
34        alert(`Thank you for your purchase!`)
35      })
36      .catch(error =&gt; {
37        this.setState({fetching: false})
38        console.log(error)
39      })
40    }).catch(error =&gt; {
41      this.setState({fetching: false})
42      console.log(error)
43    })
44  }
</pre></div>

<hr>
<a name="Create-a-Coupon-for-Testing"></a>
<div class="header">
<p>
Previous: <a href="#Send-Orders-to-Stripe-API-on-Submit" accesskey="p" rel="prev">Send Orders to Stripe API on Submit</a>, Up: <a href="#Handle-Orders-on-the-Front-End" accesskey="u" rel="up">Handle Orders on the Front End</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Create-a-Coupon-for-Testing-1"></a>
<h4 class="subsection">4.2.6 Create a Coupon for Testing</h4>

<a name="index-coupon_002c-create"></a>
<a name="index-testing-1"></a>
<a name="index-Dashboard-3"></a>
<a name="index-Billing-menu_002c-Dashboard"></a>
<a name="index-Coupons-tab_002c-Dashboard"></a>
<p>Let&rsquo;s create a coupon for testing purposes. This can be done on
the dashboard as well. You can find this option under the
<strong>Billing</strong> menu on the <strong>Coupons</strong> tab.
</p>
<a name="index-coupons_002c-multiple-types"></a>
<a name="index-coupons_002c-duration"></a>
<a name="index-coupons_002c-attached-to-Customers"></a>
<p>There are multiple types of coupons based on their duration, but
only coupons with the type <em>Once</em> can be used for orders. The rest
of the coupons can be attached to Stripe Customers.
</p>
<a name="index-coupon_002c-parameters"></a>
<p>You can also specify a lot of parameters for the coupon you
create, such as how many times it can be used, whether it is
amount based or percentage based, and when will the coupon
expire. Now we need a coupon that can be used only once and
provides a reduction on the price by a certain amount.
</p>
<div class="float"><a name="org8b8cc79"></a>
<img src="img/Stripe-Payments-Dashboard-Coupon-Creation-50.png" alt="img/Stripe-Payments-Dashboard-Coupon-Creation-50">

<div class="float-caption"><p><strong>Figure 4.3: </strong>Dashboard Coupon Creation</p></div></div>
<a name="index-webhooks_002c-set-up"></a>
<p>Great! Now we have our products, we can create orders, and we can
also ask Stripe to charge the customer&rsquo;s card for us. But we are
still not ready to ship the products as we have no idea at the
moment whether the charge was successful. To get that information,
we need to set up <em>webhooks</em>, so Stripe can let us know when the
money is on its way.
</p>
<div class="float"><a name="org4ddc1b1"></a>
<img src="img/Stripe-Payments-Shop-Orders-50.png" alt="img/Stripe-Payments-Shop-Orders-50">

<div class="float-caption"><p><strong>Figure 4.4: </strong>Stripe Payments Shop Orders</p></div></div>
<hr>
<a name="Setting-up-Stripe-Webhooks-to-Verify-Payments"></a>
<div class="header">
<p>
Next: <a href="#Wrapping-It-Up" accesskey="n" rel="next">Wrapping It Up</a>, Previous: <a href="#Placing-an-Order-With-Stripe" accesskey="p" rel="prev">Placing an Order With Stripe</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Setting-up-Stripe-Webhooks-to-Verify-Payments-1"></a>
<h2 class="chapter">5 Setting up Stripe Webhooks to Verify Payments</h2>

<a name="index-Source_002c-assigned-to-customers"></a>
<a name="index-Stripe-payment-methods"></a>
<a name="index-payment-methods_002c-several-on-Stripe"></a>
<p>As we discussed earlier, we are not assigning cards but Sources to
Customers. The reason behind that is Stripe is capable of using
<a href="https://stripe.com/docs/sources">several payment methods</a>, some of which may take days to be verified.
</p>
<a name="index-endpoint-for-Stripe-to-call-on-event"></a>
<a name="index-webhooks_002c-usefulness"></a>
<p>We need to set up an endpoint Stripe can call when an event &mdash; such
as a successful payment &mdash; has happened. Webhooks are also useful
when an event is not initiated by us via calling the API, but comes
straight from Stripe.
</p>
<a name="index-subscription-service"></a>
<a name="index-recurring-payments_002c-webhook-for"></a>
<a name="index-webhook-for-recurring-payment"></a>
<p>Imagine that you have a subscription service, and you don&rsquo;t want to
charge the customer every month. In this case, you can set up a
webhook, and you will get notified when the recurring payment was
successful or if it failed.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Webhook-Notification-When-Order-Gets-Paid" accesskey="1">Webhook Notification When Order Gets Paid</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Webhook-Notification-When-Order-Gets-Paid"></a>
<div class="header">
<p>
Up: <a href="#Setting-up-Stripe-Webhooks-to-Verify-Payments" accesskey="u" rel="up">Setting up Stripe Webhooks to Verify Payments</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Webhook-Notification-When-Order-Gets-Paid-1"></a>
<h3 class="section">5.1 Webhook Notification When Order Gets Paid</h3>

<a name="index-notification-upon-payment_002c-webhook-for"></a>
<a name="index-webhook-for-notification-of-payment"></a>
<a name="index-API-endpoint-for-webhook-notification"></a>
<a name="index-ngrok-service"></a>
<a name="index-static-ip_002c-ngrok"></a>
<p>In this example, we only want to be notified when an order gets
paid. When it happens, Stripe can notify us by calling an endpoint
on our API with an HTTP request containing the payment data in the
request body. At the moment, we don&rsquo;t have a static IP, but we need
a way to expose our local API to the public internet. We can use
<a href="https://ngrok.com/download">Ngrok</a> for that. Just download it and run with <code>./ngrok http 3001</code>
command to get an ngrok url pointing to our <code>localhost:3001</code>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Webhook-Setup-using-Stripe-Dashboard" accesskey="1">Webhook Setup using Stripe Dashboard</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Decrypting-Request-Body-Sent-by-Stripe" accesskey="2">Decrypting Request Body Sent by Stripe</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Webhook-Setup-using-Stripe-Dashboard"></a>
<div class="header">
<p>
Next: <a href="#Decrypting-Request-Body-Sent-by-Stripe" accesskey="n" rel="next">Decrypting Request Body Sent by Stripe</a>, Up: <a href="#Webhook-Notification-When-Order-Gets-Paid" accesskey="u" rel="up">Webhook Notification When Order Gets Paid</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Webhook-Setup-using-Stripe-Dashboard-1"></a>
<h4 class="subsection">5.1.1 Webhook Setup using Stripe Dashboard</h4>

<a name="index-Dashboard_002c-webhook-integration"></a>
<a name="index-Developers-Dashboard-Webhooks"></a>
<a name="index-Webhooks-Developers-Dashboard"></a>
<a name="index-endpoint_002c-add-to-Dashboard"></a>
<a name="index-Add-Endpoint_002c-Webhooks"></a>
<a name="index-ngrok-endpoint_002c-add"></a>
<p>We also have to set up our webhook on the Stripe dashboard. Go to
<strong>Developers -&gt; Webhooks</strong>, click on &lsquo;<samp>Add endpoint</samp>&rsquo; and type in your
ngrok url followed by the endpoint to be called
e.g. &lsquo;<samp>http://92832de0.ngrok.io/api/shop/order/process</samp>&rsquo;. Then under
<strong>Filter event</strong> select &lsquo;<samp>Select types to send</samp>&rsquo; and search for
<code>order.payment_succeeded</code>.
</p>
<div class="float"><a name="orge642346"></a>
<img src="img/Stripe-Dashboard-Webhook-Creation-50.png" alt="img/Stripe-Dashboard-Webhook-Creation-50">

<div class="float-caption"><p><strong>Figure 5.1: </strong>Stripe Dashboard Webhook Creation</p></div></div>
<hr>
<a name="Decrypting-Request-Body-Sent-by-Stripe"></a>
<div class="header">
<p>
Previous: <a href="#Webhook-Setup-using-Stripe-Dashboard" accesskey="p" rel="prev">Webhook Setup using Stripe Dashboard</a>, Up: <a href="#Webhook-Notification-When-Order-Gets-Paid" accesskey="u" rel="up">Webhook Notification When Order Gets Paid</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Decrypting-Request-Body-Sent-by-Stripe-1"></a>
<h4 class="subsection">5.1.2 Decrypting Request Body Sent by Stripe</h4>

<a name="index-decrypt-request-body"></a>
<a name="index-webhook-secret"></a>
<a name="index-secret_002c-webhook"></a>
<a name="index-Dashboard_002c-webhooks"></a>
<p>The data sent in the request body is encrypted and can only be
decrypted by using a signature sent in the header and with the
webhook secret that can be found on the webhooks dashboard.
</p>
<a name="index-bodyParser_002c-exception-to"></a>
<a name="index-stripe_002ewebhooks_002econstructEvent_0028_0029-function"></a>
<a name="index-message_002c-decrypt-using-Stripe-SDK"></a>
<a name="index-decrypt-message-using-Stripe-SDK"></a>
<a name="index-process-orders_002c-endpoint-for_002c-_002fapi_002fshop_002forder_002fprocess"></a>
<p>This also means that we cannot simply use <code>bodyParser</code> to parse
the body, so we need to add an exception to <code>bodyParser</code> so it
will be bypassed when the URL starts with
&lsquo;<samp>/api/shop/order/process</samp>&rsquo;. We need to use the
<code>stripe.webhooks.constructEvent()</code> function instead, provided by
the Stripe SDK to decrypt the message for us.
</p>
<a name="index-index_002ejs-3"></a>
<div class="example">
<pre class="example"> 1  // index.js
 2  const bodyParser = require('body-parser')
 3  
 4  app.use(bodyParser.json({
 5    verify: (req, res, buf) =&gt; {
 6      if (req.originalUrl.startsWith('/api/shop/order/process')) {
 7        req.rawBody = buf.toString()
 8      }
 9    }
10  }))
11  
12  app.use(bodyParser.urlencoded({
13    extended: false
14  }))
15  
16  app.post('/api/shop/order/process', async (req, res) =&gt; {
17    const sig = req.headers['stripe-signature']
18    try {
19      const event = await
20         stripe.webhooks.
21         constructEvent(req.rawBody, sig, 'whsec_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx')
22      console.log(`Processing Order : ${event.data.object.id}`)
23      // Process payed order here
24    } catch (err) {
25      return res.sendStatus(500)
26    }
27    return res.sendStatus(200)
28  })
</pre></div>

<a name="index-Salesforce-API"></a>
<a name="index-Stamps-API"></a>
<p>After an order was successfully paid, we can parse and send it to
other APIs like Salesforce or Stamps to pack things up and get
ready to send out.
</p>
<hr>
<a name="Wrapping-It-Up"></a>
<div class="header">
<p>
Next: <a href="#LIST-OF-FIGURES" accesskey="n" rel="next">LIST OF FIGURES</a>, Previous: <a href="#Setting-up-Stripe-Webhooks-to-Verify-Payments" accesskey="p" rel="prev">Setting up Stripe Webhooks to Verify Payments</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Wrapping-It-Up-1"></a>
<h2 class="chapter">6 Wrapping It Up</h2>

<p>My goal with this guide was to provide help to you through the
process of creating a Stripe-based webshop using JavaScript. I hope
you did learn from our experiences and will use this guide when you
decide to implement a similar system like this in the future.
</p>
<p>In case you need help with Stripe-based webshops, or Node &amp; React
development in general, feel free to reach out to us on
<a href="mailto:info@risingstack.com">info@risingstack.com</a>.
</p>
<hr>
<a name="LIST-OF-FIGURES"></a>
<div class="header">
<p>
Next: <a href="#LIST-OF-CODE-FRAGMENTS" accesskey="n" rel="next">LIST OF CODE FRAGMENTS</a>, Previous: <a href="#Wrapping-It-Up" accesskey="p" rel="prev">Wrapping It Up</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="LIST-OF-FIGURES-1"></a>
<h2 class="unnumbered">LIST OF FIGURES</h2>

<dl class="listoffloats">
<dt><a href="#org6c6086a">Figure 2.1</a></dt><dd><p>The Initial Stripe Dashboard View</p></dd>
<dt><a href="#org06b9b9b">Figure 3.1</a></dt><dd><p>Stripe Payments Dashboard API Key</p></dd>
<dt><a href="#org2ac7407">Figure 3.2</a></dt><dd><p>Restricted API Key in the Dashboard Developers Menu</p></dd>
<dt><a href="#org1bb42b3">Figure 4.1</a></dt><dd><p>Create a Product</p></dd>
<dt><a href="#orgfb1e238">Figure 4.2</a></dt><dd><p>Create a SKU</p></dd>
<dt><a href="#org8b8cc79">Figure 4.3</a></dt><dd><p>Dashboard Coupon Creation</p></dd>
<dt><a href="#org4ddc1b1">Figure 4.4</a></dt><dd><p>Stripe Payments Shop Orders</p></dd>
<dt><a href="#orge642346">Figure 5.1</a></dt><dd><p>Stripe Dashboard Webhook Creation</p></dd>
</dl>

<hr>
<a name="LIST-OF-CODE-FRAGMENTS"></a>
<div class="header">
<p>
Next: <a href="#CONCEPT-INDEX" accesskey="n" rel="next">CONCEPT INDEX</a>, Previous: <a href="#LIST-OF-FIGURES" accesskey="p" rel="prev">LIST OF FIGURES</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="LIST-OF-CODE-FRAGMENTS-1"></a>
<h2 class="unnumbered">LIST OF CODE FRAGMENTS</h2>

<dl class="listoffloats">
<dt><a href="#org061880f">Listing 3.1</a></dt><dd><p>Create the Webshop Front End</p></dd>
<dt><a href="#orgdc53676">Listing 3.2</a></dt><dd><p><code>StripeProvider</code> Component in Root Component</p></dd>
<dt><a href="#orgf8b82a0">Listing 3.3</a></dt><dd><p>Inject Stripe from react-stripe-elements</p></dd>
<dt><a href="#org8f4cc4e">Listing 4.1</a></dt><dd><p>Initial Framework for Server <code>index.js</code></p></dd>
<dt><a href="#orgd4638cf">Listing 4.2</a></dt><dd><p>App Post Function</p></dd>
</dl>

<hr>
<a name="CONCEPT-INDEX"></a>
<div class="header">
<p>
Next: <a href="#SOURCE-INDEX" accesskey="n" rel="next">SOURCE INDEX</a>, Previous: <a href="#LIST-OF-CODE-FRAGMENTS" accesskey="p" rel="prev">LIST OF CODE FRAGMENTS</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="CONCEPT-INDEX-1"></a>
<h2 class="unnumbered">CONCEPT INDEX</h2>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#CONCEPT-INDEX_cp_symbol-1"><b>&lt;</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_symbol-2"><b>~</b></a>
 &nbsp; 
<br>
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-K"><b>K</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-Q"><b>Q</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-W"><b>W</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-cp" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_symbol-1">&lt;</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_003cscript_003e_002e_002e_002e_003c_002fscript_003e">&lsquo;<samp>&lt;script&gt;...&lt;/script&gt;</samp>&rsquo;</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Add-Stripejs-Code-to-indexhtml-File">Add <code>Stripejs</code> Code to <code>indexhtml</code> File</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_symbol-2">~</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_007ereact_002dstripe_002delements_007e">~react-stripe-elements~</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-access-key_002c-public">access key, public</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Add-Endpoint_002c-Webhooks">Add Endpoint, Webhooks</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Webhook-Setup-using-Stripe-Dashboard">Webhook Setup using Stripe Dashboard</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-address-object">address object</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-State-of-Shop-Component">Implement State of Shop Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-API">API</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Developers-Section">Stripe Developers Section</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-API-1">API</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-State-of-Shop-Component">Implement State of Shop Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-API-endpoint-for-webhook-notification">API endpoint for webhook notification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Webhook-Notification-When-Order-Gets-Paid">Webhook Notification When Order Gets Paid</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-API-key_002c-create-restricted">API key, create restricted</a>:</td><td>&nbsp;</td><td valign="top"><a href="#POST-Request-to-Stripe">POST Request to Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-API-key_002c-Stripe-Dashboard">API key, Stripe Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-api-keys">api keys</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Developers-Section">Stripe Developers Section</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-API-keys">API keys</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-API_002c-expose-to-handle-order">API, expose to handle order</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Placing-an-Order-With-Stripe">Placing an Order With Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-API_002c-send-orders-to">API, send orders to</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Send-Orders-to-Stripe-API-on-Submit">Send Orders to Stripe API on Submit</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-apiKey"><code>apiKey</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-apiKey-1"><code>apiKey</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-App_002ejs"><samp>App.js</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-author_002c-about">author, about</a>:</td><td>&nbsp;</td><td valign="top"><a href="#About-The-Author">About The Author</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-authorization">authorization</a>:</td><td>&nbsp;</td><td valign="top"><a href="#POST-Request-to-Stripe">POST Request to Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-axios">axios</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-axios-1"><samp>axios</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-the-React-App-and-Install-Stripe-Elements-and-Axios">Create the React App and Install Stripe Elements and Axios</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-axios-2"><samp>axios</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Charge-a-Credit-Card-in-Shopjs">Charge a Credit Card in <samp>Shopjs</samp></a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-B">B</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-back-end">back end</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-backend_002c-github">backend, github</a>:</td><td>&nbsp;</td><td valign="top"><a href="#About-the-Project">About the Project</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Billing-menu_002c-Dashboard">Billing menu, Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-Coupon-for-Testing">Create a Coupon for Testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-body_002dparser_002c-node"><samp>body-parser</samp>, node</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-bodyParser_002c-exception-to"><samp>bodyParser</samp>, exception to</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Decrypting-Request-Body-Sent-by-Stripe">Decrypting Request Body Sent by Stripe</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Card-Token">Card Token</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Card-Token-1">Card Token</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Use-Card-Token-as-Source">Use Card Token as &lsquo;<samp>Source</samp>&rsquo;</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Card-Token-ID">Card Token ID</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-CardElement"><samp>CardElement</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-charge-a-customer">charge a customer</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-charges_002c-multiple">charges, multiple</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-charges_002c-recurring">charges, recurring</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-code-samples_002c-github">code samples, github</a>:</td><td>&nbsp;</td><td valign="top"><a href="#About-the-Project">About the Project</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-convert-objects-to-query-strings">convert objects to query strings</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-CORS">CORS</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cors_002c-node"><samp>cors</samp>, node</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-coupon">coupon</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-State-of-Shop-Component">Implement State of Shop Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-coupon_002c-create">coupon, create</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-Coupon-for-Testing">Create a Coupon for Testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-coupon_002c-create-new">coupon, create new</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-New-Coupon-or-Product">Create a New Coupon or Product</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-coupon_002c-parameters">coupon, parameters</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-Coupon-for-Testing">Create a Coupon for Testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Coupons-tab_002c-Dashboard">Coupons tab, Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-Coupon-for-Testing">Create a Coupon for Testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-coupons_002c-attached-to-Customers">coupons, attached to Customers</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-Coupon-for-Testing">Create a Coupon for Testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-coupons_002c-duration">coupons, duration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-Coupon-for-Testing">Create a Coupon for Testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-coupons_002c-multiple-types">coupons, multiple types</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-Coupon-for-Testing">Create a Coupon for Testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-create-new-coupon-or-product">create new coupon or product</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-New-Coupon-or-Product">Create a New Coupon or Product</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-create-Stripe-order">create Stripe order</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-CC-Charges-in-indexjs">Implement CC Charges in <code>indexjs</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-create_002dreact_002dapp">create-react-app</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-create_002dreact_002dapp-1"><code>create-react-app</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-the-React-App-and-Install-Stripe-Elements-and-Axios">Create the React App and Install Stripe Elements and Axios</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-createToken_0028_0029-function"><code>createToken()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-credit-card-details_002c-raw">credit card details, raw</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-credit-card-identification">credit card identification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-credit-card-security">credit card security</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-credit-card_002c-charge">credit card, charge</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-credit-card_002c-charge-1">credit card, charge</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Charge-a-Credit-Card-in-Shopjs">Charge a Credit Card in <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-credit-card_002c-charge_002c-POST-request">credit card, charge, POST request</a>:</td><td>&nbsp;</td><td valign="top"><a href="#POST-Request-to-Stripe">POST Request to Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-credit-card_002c-details">credit card, details</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-credit-card_002c-secure-inputs">credit card, secure inputs</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-credit-card_002c-tokenized">credit card, tokenized</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-css_002c-form-style">css, form style</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Customer_002c-create">Customer, create</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-dashboard">dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Signup-To-Stripe">Signup To Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dashboard">Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dashboard-1">Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#POST-Request-to-Stripe">POST Request to Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dashboard-2">Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-Products-and-Assign-SKUs">Create Products and Assign SKUs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dashboard-3">Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-Coupon-for-Testing">Create a Coupon for Testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dashboard-Developers-API-keys">Dashboard Developers API keys</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Access-Stripe-in-Server-indexjs">Access Stripe in Server <code>indexjs</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dashboard-menu">Dashboard menu</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dashboard_002c-define-SKU-in-Stripe">Dashboard, define SKU in Stripe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-Input-Fields">Create Input Fields</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dashboard_002c-Developers-section">dashboard, Developers section</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Developers-Section">Stripe Developers Section</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dashboard_002c-Stripe">Dashboard, Stripe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dashboard_002c-webhook-integration">Dashboard, webhook integration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Webhook-Setup-using-Stripe-Dashboard">Webhook Setup using Stripe Dashboard</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dashboard_002c-webhooks">Dashboard, webhooks</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Decrypting-Request-Body-Sent-by-Stripe">Decrypting Request Body Sent by Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-data_002c-shipping">data, shipping</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-data_002c-store-on-Stripe">data, store on Stripe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-decrypt-message-using-Stripe-SDK">decrypt message using Stripe SDK</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Decrypting-Request-Body-Sent-by-Stripe">Decrypting Request Body Sent by Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-decrypt-request-body">decrypt request body</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Decrypting-Request-Body-Sent-by-Stripe">Decrypting Request Body Sent by Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Developers-Dashboard-Webhooks">Developers Dashboard Webhooks</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Webhook-Setup-using-Stripe-Dashboard">Webhook Setup using Stripe Dashboard</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Developers-menu">Developers menu</a>:</td><td>&nbsp;</td><td valign="top"><a href="#POST-Request-to-Stripe">POST Request to Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Developers-section_002c-Dashboard">Developers section, Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Developers-Section">Stripe Developers Section</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Developers-section_002c-Dashboard-1">Developers section, Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-discount">discount</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Elements"><samp>Elements</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Elements-1"><samp>Elements</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implementation-of-Shopjs-Component">Implementation of <samp>Shopjs</samp> Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-endpoint-for-Stripe-to-call-on-event">endpoint for Stripe to call on event</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting-up-Stripe-Webhooks-to-Verify-Payments">Setting up Stripe Webhooks to Verify Payments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-endpoint_002c-add-to-Dashboard">endpoint, add to Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Webhook-Setup-using-Stripe-Dashboard">Webhook Setup using Stripe Dashboard</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-endpoints_002c-different-for-order-and-payment">endpoints, different for order and payment</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Use-Card-Token-as-Source">Use Card Token as &lsquo;<samp>Source</samp>&rsquo;</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-express"><samp>express</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-express-server_002c-set-up">express server, set up</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-fields_002c-address-object">fields, address object</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-State-of-Shop-Component">Implement State of Shop Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-form_002c-React">form, React</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-front-end">front end</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-the-React-App-and-Install-Stripe-Elements-and-Axios">Create the React App and Install Stripe Elements and Axios</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-front-end_002c-order-handling">front end, order handling</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Handle-Orders-on-the-Front-End">Handle Orders on the Front End</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-frontend_002c-github">frontend, github</a>:</td><td>&nbsp;</td><td valign="top"><a href="#About-the-Project">About the Project</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-G">G</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-github-sources">github sources</a>:</td><td>&nbsp;</td><td valign="top"><a href="#About-the-Project">About the Project</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-H">H</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-handleSubmit"><code>handleSubmit</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-headers_002c-security">headers, security</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Helmet">Helmet</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-helmet_002c-node"><samp>helmet</samp>, node</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-higher_002dorder_002dcomponent_002c-injectStripe">higher-order-component, <samp>injectStripe</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-I">I</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-identify-credit-card_002c-how">identify credit card, how</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-index_002ehtml"><samp>index.html</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Add-Stripejs-Code-to-indexhtml-File">Add <code>Stripejs</code> Code to <code>indexhtml</code> File</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-index_002ejs"><samp>index.js</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Access-Stripe-in-Server-indexjs">Access Stripe in Server <code>indexjs</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-injectStripe"><code>injectStripe</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implementation-of-Shopjs-Component">Implementation of <samp>Shopjs</samp> Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-injectStripe-1"><samp>injectStripe</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-injectStripe-hoc"><samp>injectStripe</samp> hoc</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-injectStripe_0028Shop_0029-function"><code>injectStripe(Shop)</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-input-fields_002c-create">input fields, create</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-Input-Fields">Create Input Fields</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-integrate-Stripe-into-product">integrate Stripe into product</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integrate-Stripe-Into-a-Product">Integrate Stripe Into a Product</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-international-cards">international cards</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Charge-a-Credit-Card-in-Shopjs">Charge a Credit Card in <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Inventory-group">Inventory group</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-Products-and-Assign-SKUs">Create Products and Assign SKUs</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-K">K</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-key_002c-public-access">key, public access</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-L">L</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-list-orders">list orders</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_002c-decrypt-using-Stripe-SDK">message, decrypt using Stripe SDK</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Decrypting-Request-Body-Sent-by-Stripe">Decrypting Request Body Sent by Stripe</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-ngrok-endpoint_002c-add">ngrok endpoint, add</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Webhook-Setup-using-Stripe-Dashboard">Webhook Setup using Stripe Dashboard</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ngrok-service">ngrok service</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Webhook-Notification-When-Order-Gets-Paid">Webhook Notification When Order Gets Paid</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-node-packages_002c-other-needed">node packages, other needed</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-notification-upon-payment_002c-webhook-for">notification upon payment, webhook for</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Webhook-Notification-When-Order-Gets-Paid">Webhook Notification When Order Gets Paid</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-npm"><code>npm</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-npm-install"><code>npm install</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-the-React-App-and-Install-Stripe-Elements-and-Axios">Create the React App and Install Stripe Elements and Axios</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-npx"><code>npx</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-the-React-App-and-Install-Stripe-Elements-and-Axios">Create the React App and Install Stripe Elements and Axios</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-object_002c-state">object, state</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-State-of-Shop-Component">Implement State of Shop Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-order-request_002c-should-look-like">order request, should look like</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-State-of-Shop-Component">Implement State of Shop Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-order_002c-create">order, create</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Placing-an-Order-With-Stripe">Placing an Order With Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-order_002c-create-Stripe">order, create Stripe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-CC-Charges-in-indexjs">Implement CC Charges in <code>indexjs</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-order_002c-parse">order, parse</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Add-Products-to-the-Webshop">Add Products to the Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-order_002c-send-in-code">order, send in code</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Send-Orders-to-Stripe-API-on-Submit">Send Orders to Stripe API on Submit</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-orders-and-products">orders and products</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Placing-an-Order-With-Stripe">Placing an Order With Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-orders_002c-handle-on-the-UI">orders, handle on the UI</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Handle-Orders-on-the-Front-End">Handle Orders on the Front End</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-orders_002c-list-on-UI">orders, list on UI</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-orders_002c-send">orders, send</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Send-Orders-to-Stripe-API-on-Submit">Send Orders to Stripe API on Submit</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-parse-order">parse order</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Add-Products-to-the-Webshop">Add Products to the Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-payment-methods_002c-several-on-Stripe">payment methods, several on Stripe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting-up-Stripe-Webhooks-to-Verify-Payments">Setting up Stripe Webhooks to Verify Payments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-POST-request_002c-credit-card">POST request, credit card</a>:</td><td>&nbsp;</td><td valign="top"><a href="#POST-Request-to-Stripe">POST Request to Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-post_002c-axios">post, axios</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Charge-a-Credit-Card-in-Shopjs">Charge a Credit Card in <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-post_002c-axios-1">post, axios</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Send-Orders-to-Stripe-API-on-Submit">Send Orders to Stripe API on Submit</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-post_002c-order">post, order</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-CC-Charges-in-indexjs">Implement CC Charges in <code>indexjs</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-process-orders_002c-endpoint-for_002c-_002fapi_002fshop_002forder_002fprocess">process orders, endpoint for, <samp>/api/shop/order/process</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Decrypting-Request-Body-Sent-by-Stripe">Decrypting Request Body Sent by Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-product_002c-create-new">product, create new</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-New-Coupon-or-Product">Create a New Coupon or Product</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-products-and-orders">products and orders</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Placing-an-Order-With-Stripe">Placing an Order With Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-products-in-webshop">products in webshop</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Creating-a-Webshop-in-React-with-Charges">Creating a Webshop in React with Charges</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-products_002c-create">products, create</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-Products-and-Assign-SKUs">Create Products and Assign SKUs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-project">project</a>:</td><td>&nbsp;</td><td valign="top"><a href="#About-the-Project">About the Project</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-props">props</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-props_002estripe_002ecreateToken_0028_0029"><code>props.stripe.createToken()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Charge-a-Credit-Card-in-Shopjs">Charge a Credit Card in <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-public-access-key">public access key</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Publishable-key">Publishable key</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-purchasable-items_002c-define">purchasable items, define</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-Input-Fields">Create Input Fields</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-Q">Q</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-query_002dstring_002dobject">query-string-object</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-query_002dstring_002dobject-1"><samp>query-string-object</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-the-React-App-and-Install-Stripe-Elements-and-Axios">Create the React App and Install Stripe Elements and Axios</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-React-app_002c-setup">React app, setup</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-the-React-App-and-Install-Stripe-Elements-and-Axios">Create the React App and Install Stripe Elements and Axios</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-React-app_002c-Webshop">React app, Webshop</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Creating-a-Webshop-in-React-with-Charges">Creating a Webshop in React with Charges</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-React-form">React form</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-react-props">react props</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-react-root-component">react root component</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-React-Stripe-Elements">React Stripe Elements</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-react_002dstripe_002delements"><samp>react-stripe-elements</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-react_002dstripe_002delements-1"><samp>react-stripe-elements</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-react_002dstripe_002delements-2"><samp>react-stripe-elements</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-recurring-payments_002c-webhook-for">recurring payments, webhook for</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting-up-Stripe-Webhooks-to-Verify-Payments">Setting up Stripe Webhooks to Verify Payments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-restricted-api-keys">restricted api keys</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Developers-Section">Stripe Developers Section</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-root-react-component">root react component</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-routes_002c-API">routes, API</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Salesforce-API">Salesforce API</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Decrypting-Request-Body-Sent-by-Stripe">Decrypting Request Body Sent by Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-secret-key">secret key</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Access-Stripe-in-Server-indexjs">Access Stripe in Server <code>indexjs</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-secret_002c-webhook">secret, webhook</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Decrypting-Request-Body-Sent-by-Stripe">Decrypting Request Body Sent by Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-security-headers">security headers</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-send-orders">send orders</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Send-Orders-to-Stripe-API-on-Submit">Send Orders to Stripe API on Submit</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-separate-order-from-payment">separate order from payment</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Use-Card-Token-as-Source">Use Card Token as &lsquo;<samp>Source</samp>&rsquo;</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-server-code_002c-skeleton">server code, skeleton</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-server_002c-set-up">server, set up</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Placing-an-Order-With-Stripe">Placing an Order With Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Shop-component">Shop component</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Shop-component-1">Shop component</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-State-of-Shop-Component">Implement State of Shop Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Shop-component_002c-charge-credit-card">Shop component, charge credit card</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Charge-a-Credit-Card-in-Shopjs">Charge a Credit Card in <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Shop-object">Shop object</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-State-of-Shop-Component">Implement State of Shop Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Shop_002ejs"><samp>Shop.js</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implementation-of-Shopjs-Component">Implementation of <samp>Shopjs</samp> Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-signup">signup</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Signup-To-Stripe">Signup To Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-single-click-shopping">single click shopping</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SKU_002c-assign">SKU, assign</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-Products-and-Assign-SKUs">Create Products and Assign SKUs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SKU_002c-define-in-Stripe">SKU, define in Stripe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-Input-Fields">Create Input Fields</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Source">&lsquo;<samp>Source</samp>&rsquo;</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Source-1">&lsquo;<samp>Source</samp>&rsquo;</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Use-Card-Token-as-Source">Use Card Token as &lsquo;<samp>Source</samp>&rsquo;</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Source_002c-assigned-to-customers">Source, assigned to customers</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting-up-Stripe-Webhooks-to-Verify-Payments">Setting up Stripe Webhooks to Verify Payments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stamps-API">Stamps API</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Decrypting-Request-Body-Sent-by-Stripe">Decrypting Request Body Sent by Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-state_002c-implement-Shop-Component">state, implement Shop Component</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-State-of-Shop-Component">Implement State of Shop Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-static-ip_002c-ngrok">static ip, ngrok</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Webhook-Notification-When-Order-Gets-Paid">Webhook Notification When Order Gets Paid</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stock-Keeping-Unit-_0028SKU_0029">Stock Keeping Unit (SKU)</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-Input-Fields">Create Input Fields</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-account_002c-setup">Stripe account, setup</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Setup-and-Dashboard">Stripe Setup and Dashboard</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-API">Stripe API</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-State-of-Shop-Component">Implement State of Shop Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-API-documentation_002c-link-to">Stripe API documentation, link to</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-New-Coupon-or-Product">Create a New Coupon or Product</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-Customer">Stripe Customer</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-Customer_002c-benefit-of-using">Stripe Customer, benefit of using</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Customers">Stripe Customers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-dashboard">Stripe dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Signup-To-Stripe">Signup To Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-Dashboard">Stripe Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-Elements">Stripe Elements</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-form-element">Stripe form element</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-object">Stripe object</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-object_002c-as-prop">Stripe object, as prop</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-payment-methods">Stripe payment methods</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting-up-Stripe-Webhooks-to-Verify-Payments">Setting up Stripe Webhooks to Verify Payments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-product-integration">Stripe product integration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integrate-Stripe-Into-a-Product">Integrate Stripe Into a Product</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-requests">Stripe requests</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-signup">Stripe signup</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Signup-To-Stripe">Signup To Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe-Webshop_002c-create">Stripe Webshop, create</a>:</td><td>&nbsp;</td><td valign="top"><a href="#About-the-Project">About the Project</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe_002c-access-from-server">Stripe, access from server</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Access-Stripe-in-Server-indexjs">Access Stripe in Server <code>indexjs</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe_002c-in-React-form">Stripe, in React form</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe_002c-what-it-is">Stripe, what it is</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Basics-of-Stripe-Payments-Integration">The Basics of Stripe Payments Integration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe_002ejs"><samp>Stripe.js</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe_002ejs-1"><samp>Stripe.js</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Add-Stripejs-Code-to-indexhtml-File">Add <code>Stripejs</code> Code to <code>indexhtml</code> File</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stripe_002ejs-link"><samp>Stripe.js</samp> link</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integrate-Stripe-Into-a-Product">Integrate Stripe Into a Product</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stripe_002eorders_002ecreate_0028_0029-function"><code>stripe.orders.create()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Access-Stripe-in-Server-indexjs">Access Stripe in Server <code>indexjs</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stripe_002eorders_002epay_0028_0029-function"><code>stripe.orders.pay()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Use-Card-Token-as-Source">Use Card Token as &lsquo;<samp>Source</samp>&rsquo;</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stripe_002ewebhooks_002econstructEvent_0028_0029-function"><code>stripe.webhooks.constructEvent()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Decrypting-Request-Body-Sent-by-Stripe">Decrypting Request Body Sent by Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-StripeProvider"><samp>StripeProvider</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-StripeProvider-component">StripeProvider component</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-submit-button_002c-disable">submit button, disable</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-Input-Fields">Create Input Fields</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-subscription-service">subscription service</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting-up-Stripe-Webhooks-to-Verify-Payments">Setting up Stripe Webhooks to Verify Payments</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-testing">testing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Charge-a-Credit-Card-in-Shopjs">Charge a Credit Card in <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-testing-1">testing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-Coupon-for-Testing">Create a Coupon for Testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-token_002c-from-Stripe">token, from Stripe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tokenization_002c-credit-card-data">tokenization, credit card data</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tokenize_002c-credit-card">tokenize, credit card</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-total-price-of-orders_002c-automatic-calculation">total price of orders, automatic calculation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Send-Orders-to-Stripe-API-on-Submit">Send Orders to Stripe API on Submit</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-U">U</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-UI_002c-order-handling">UI, order handling</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Handle-Orders-on-the-Front-End">Handle Orders on the Front End</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="CONCEPT-INDEX_cp_letter-W">W</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-WARNING_002c-raw-credit-card-details">WARNING, raw credit card details</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Steps-for-Creating-a-Webshop">Steps for Creating a Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-webhook">webhook</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Developers-Section">Stripe Developers Section</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-webhook-for-notification-of-payment">webhook for notification of payment</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Webhook-Notification-When-Order-Gets-Paid">Webhook Notification When Order Gets Paid</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-webhook-for-recurring-payment">webhook for recurring payment</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting-up-Stripe-Webhooks-to-Verify-Payments">Setting up Stripe Webhooks to Verify Payments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-webhook-secret">webhook secret</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Decrypting-Request-Body-Sent-by-Stripe">Decrypting Request Body Sent by Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-webhook_002c-to-process-order">webhook, to process order</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Placing-an-Order-With-Stripe">Placing an Order With Stripe</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Webhooks-Developers-Dashboard">Webhooks Developers Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Webhook-Setup-using-Stripe-Dashboard">Webhook Setup using Stripe Dashboard</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-webhooks_002c-set-up">webhooks, set up</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-a-Coupon-for-Testing">Create a Coupon for Testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-webhooks_002c-usefulness">webhooks, usefulness</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting-up-Stripe-Webhooks-to-Verify-Payments">Setting up Stripe Webhooks to Verify Payments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-webshop"><samp>webshop</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-the-React-App-and-Install-Stripe-Elements-and-Axios">Create the React App and Install Stripe Elements and Axios</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-webshop-creation">webshop creation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Creating-a-Webshop-in-React-with-Charges">Creating a Webshop in React with Charges</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-webshop-products">webshop products</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Creating-a-Webshop-in-React-with-Charges">Creating a Webshop in React with Charges</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Webshop_002c-add-products-to">Webshop, add products to</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Add-Products-to-the-Webshop">Add Products to the Webshop</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#CONCEPT-INDEX_cp_symbol-1"><b>&lt;</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_symbol-2"><b>~</b></a>
 &nbsp; 
<br>
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-K"><b>K</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-Q"><b>Q</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#CONCEPT-INDEX_cp_letter-W"><b>W</b></a>
 &nbsp; 
</td></tr></table>

<hr>
<a name="SOURCE-INDEX"></a>
<div class="header">
<p>
Previous: <a href="#CONCEPT-INDEX" accesskey="p" rel="prev">CONCEPT INDEX</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#CONCEPT-INDEX" title="Index" rel="index">Index</a>]</p>
</div>
<a name="SOURCE-INDEX-1"></a>
<h2 class="unnumbered">SOURCE INDEX</h2>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#SOURCE-INDEX_pg_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#SOURCE-INDEX_pg_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#SOURCE-INDEX_pg_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#SOURCE-INDEX_pg_letter-S"><b>S</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-pg" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="SOURCE-INDEX_pg_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-App_002ejs-1"><code>App.js</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Stripe-Object-in-Root-React-Component-Appjs">Stripe Object in Root React Component <samp>Appjs</samp></a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="SOURCE-INDEX_pg_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-create_002dscript"><code>create-script</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-the-React-App-and-Install-Stripe-Elements-and-Axios">Create the React App and Install Stripe Elements and Axios</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="SOURCE-INDEX_pg_letter-I">I</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-index_002ejs-1"><code>index.js</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Set-Up-an-Express-Server">Set Up an Express Server</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-index_002ejs-2"><code>index.js</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-CC-Charges-in-indexjs">Implement CC Charges in <code>indexjs</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-index_002ejs-3"><code>index.js</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Decrypting-Request-Body-Sent-by-Stripe">Decrypting Request Body Sent by Stripe</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="SOURCE-INDEX_pg_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Shop_002ejs-1"><code>Shop.js</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implementation-of-Shopjs-Component">Implementation of <samp>Shopjs</samp> Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Shop_002ejs-2"><code>Shop.js</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Explanation-of-Shopjs">Explanation of <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Shop_002ejs-3"><code>Shop.js</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Charge-a-Credit-Card-in-Shopjs">Charge a Credit Card in <samp>Shopjs</samp></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Shop_002ejs-4"><code>Shop.js</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Implement-State-of-Shop-Component">Implement State of Shop Component</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Shop_002ejs-5"><code>Shop.js</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Create-Input-Fields">Create Input Fields</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Shop_002ejs-6"><code>Shop.js</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Add-Products-to-the-Webshop">Add Products to the Webshop</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Shop_002ejs-7"><code>Shop.js</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Send-Orders-to-Stripe-API-on-Submit">Send Orders to Stripe API on Submit</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#SOURCE-INDEX_pg_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#SOURCE-INDEX_pg_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#SOURCE-INDEX_pg_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#SOURCE-INDEX_pg_letter-S"><b>S</b></a>
 &nbsp; 
</td></tr></table>

<hr>



</body>
</html>
